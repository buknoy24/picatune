<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Picasso - Create & Sell Art</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="index.css">
    
    <!-- Firebase App (the core Firebase SDK) -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-analytics.js";

      const firebaseConfig = {
        apiKey: "AIzaSyA1Tj7WH2OzVEylBsML66FA342RlDValgw",
        authDomain: "picasso-92ad0.firebaseapp.com",
        projectId: "picasso-92ad0",
        storageBucket: "picasso-92ad0.firebasestorage.app",
        messagingSenderId: "378901074490",
        appId: "1:378901074490:web:d307bb25082fbd87ff9b03",
        measurementId: "G-7PD6LQRL2R"
      };

      const app = initializeApp(firebaseConfig);
      const analytics = getAnalytics(app);
    </script>
    <!-- Add other Firebase SDKs as needed -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

    <style>
        :root {
  --bg-primary: #000;
  --bg-secondary: #111;
  --text-primary: #fff;
  --text-secondary: #aaa;
  --accent-primary: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
  --card-bg: #1a1a1a;
  --card-border: #333;
  --input-bg: #222;
}

[data-theme="light"] {
  --bg-primary: #fff;
  --bg-secondary: #f5f5f5;
  --text-primary: #000;
  --text-secondary: #555;
  --accent-primary: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
  --card-bg: #fff;
  --card-border: #ddd;
  --input-bg: #eee;
}

body {
  background: var(--bg-primary);
  color: var(--text-primary);
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  transition: all 0.3s ease;
}

.gradient-logo {
  background: var(--accent-primary);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.action-btn {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.action-btn:hover {
  background: rgba(255, 255, 255, 0.2);
  transform: scale(1.05);
}

.brush-icon {
  background: var(--accent-primary);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.live-badge {
  background: linear-gradient(45deg, #ff0050, #ff4081);
  animation: pulse 2s infinite;
}

.notification-badge {
  background: linear-gradient(45deg, #ff0050, #ff4081);
  position: absolute;
  top: -5px;
  right: -5px;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  font-size: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.category-pill {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 20px;
  padding: 6px 12px;
  font-size: 0.8rem;
  margin: 5px;
  cursor: pointer;
  transition: all 0.2s;
}

.category-pill.active {
  background: var(--accent-primary);
  border: none;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

.tip-btn {
  display: true; /* Hidden by default */
}

.busking-item .tip-btn {
  display: block; /* Show only for busking category */
}

.boost-btn {
  background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
}

.boost-btn:hover {
  background: linear-gradient(45deg, #764ba2 0%, #667eea 100%);
}

.buy-btn {
  background: linear-gradient(45deg, #ff6b6b, #ee5a24);
}

.buy-btn:hover {
  background: linear-gradient(45deg, #ee5a24, #ff6b6b);
  transform: translateY(-1px);
}

.follow-btn {
  background: linear-gradient(45deg, #667eea, #764ba2);
}

.follow-btn:hover {
  background: linear-gradient(45deg, #764ba2, #667eea);
}

.product-tag {
  background: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.tab-active {
  background: linear-gradient(45deg, #667eea, #764ba2);
  color: white;
}

.tab-inactive {
  background: rgba(255, 255, 255, 0.1);
  color: #ccc;
}

.top-nav-item {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.top-nav-item:hover {
  background: rgba(255, 255, 255, 0.2);
}

/* Camera Modal Styles */
.camera-modal {
  width: 100%;
  height: 100vh;
  max-width: none;
  max-height: none;
  margin: 0;
  border-radius: 0;
  background: #000;
  display: flex;
  flex-direction: column;
}

.camera-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px;
  background: rgba(0, 0, 0, 0.8);
  color: white;
}

.close-camera, .camera-flip {
  background: none;
  border: none;
  color: white;
  font-size: 24px;
  cursor: pointer;
  padding: 10px;
  border-radius: 50%;
  transition: background 0.3s;
}

.close-camera:hover, .camera-flip:hover {
  background: rgba(255, 255, 255, 0.1);
}

.camera-container {
  flex: 1;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

#cameraPreview {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.camera-controls {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 30px;
  background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
}

.recording-timer {
  color: #ff4757;
  font-size: 18px;
  font-weight: bold;
  background: rgba(0, 0, 0, 0.8);
  padding: 8px 16px;
  border-radius: 20px;
}

.camera-buttons {
  display: flex;
  align-items: center;
  justify-content: center;
}

.record-btn {
  width: 80px;
  height: 80px;
  border: 4px solid white;
  border-radius: 50%;
  background: transparent;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s;
}

.record-btn:hover {
  transform: scale(1.1);
}

.record-btn.recording {
  border-color: #ff4757;
}

.record-circle {
  width: 60px;
  height: 60px;
  background: #ff4757;
  border-radius: 50%;
  transition: all 0.3s;
}

.record-btn.recording .record-circle {
  width: 30px;
  height: 30px;
  border-radius: 4px;
}

.camera-actions {
  display: flex;
  gap: 30px;
}

.camera-action {
  width: 50px;
  height: 50px;
  border: 2px solid rgba(255, 255, 255, 0.5);
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.1);
  color: white;
  font-size: 20px;
  cursor: pointer;
  transition: all 0.3s;
}

.camera-action:hover {
  background: rgba(255, 255, 255, 0.2);
  border-color: white;
}

/* Upload Area Styles */
.upload-area {
  border: 2px dashed #666;
  border-radius: 12px;
  padding: 40px;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s;
  margin: 20px 0;
}

.upload-area:hover {
  border-color: #ff6b6b;
  background: rgba(255, 107, 107, 0.05);
}

.upload-area i {
  font-size: 48px;
  color: #666;
  margin-bottom: 16px;
}

.upload-area p {
  font-size: 18px;
  margin-bottom: 8px;
}

.upload-area small {
  color: #888;
}

.upload-actions {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
  margin-top: 20px;
}

/* Comments Section */
.comments-section {
  background: rgba(31, 41, 55, 0.9);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(75, 85, 99, 0.3);
}

/* Ensure categories flex container does not clip dropdown */
.px-4.mb-6 > .flex {
  overflow: visible !important;
  position: relative;
}

/* Services Dropdown */
.services-dropdown {
  background: rgba(31, 41, 55, 0.95);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(75, 85, 99, 0.3);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
  z-index: 9999;
}

/* Dropdown Overlay Fixes */
#servicesDropdown,
#instrumentsDropdown {
    position: absolute !important;
    z-index: 99999 !important;
    pointer-events: auto !important;
}

/* Ensure parent containers don't clip dropdowns */
.relative {
    overflow: visible !important;
}

/* Force dropdowns to be on top */
.services-dropdown {
    position: absolute !important;
    z-index: 99999 !important;
    overflow: visible !important;
}

/* Mobile Optimizations */
@media (max-width: 768px) {
  .camera-modal {
      height: 100vh;
      height: 100dvh; /* Dynamic viewport height for mobile */
  }

  .header {
    padding-left: 1rem;
    padding-right: 1rem;
  }

  .header .flex.items-center.space-x-6 {
    gap: 0.5rem;
  }

  .header .flex.items-center.space-x-4 {
    gap: 0.5rem;
  }

  .main-nav {
    overflow-x: auto;
    scrollbar-width: none; /* Firefox */
  }

  .main-nav::-webkit-scrollbar {
    display: none; /* Safari and Chrome */
  }

  .main-nav .flex {
    padding-bottom: 0.5rem;
  }
  
  .messages-panel {
      width: 100vw !important;
      max-width: none !important;
      height: 100vh;
      height: 100dvh;
  }

  .search-overlay {
      padding: 10px;
  }

  .shopping-cart-panel {
      width: 100vw !important;
      max-width: none !important;
      height: 100vh;
      height: 100dvh;
      padding-top: 60px;
  }

  .favorites-panel {
      width: 100vw !important;
      max-width: none !important;
      height: 100vh;
      height: 100dvh;
      padding-top: 60px;
  }

  .checkout-panel {
      width: 100vw !important;
      max-width: none !important;
      height: 100vh;
      height: 100dvh;
      padding-top: 60px;
  }

  /* Make modals full screen on mobile */
  .modal-content {
      width: 100vw;
      height: 100vh;
      max-width: none;
      max-height: none;
      border-radius: 0;
      margin: 0;
  }

  /* Adjust video interaction buttons for mobile */
  .video-interactions {
      right: 8px;
      bottom: 80px;
  }

  .video-interactions .action-btn {
      width: 44px;
      height: 44px;
      margin-bottom: 12px;
  }

  .products-grid {
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 10px;
  }

  /* Better touch targets */
  .nav-btn {
      min-height: 48px;
      min-width: 48px;
  }

  /* Responsive text */
  .text-responsive {
      font-size: clamp(0.875rem, 2.5vw, 1rem);
  }
}

@media (max-width: 640px) {
  .products-grid {
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 8px;
  }
}

/* Yellow state for available bid/tip buttons */
.bid-available {
  color: #fbbf24 !important;
}

.tip-available {
  color: #fbbf24 !important;
}

/* Navigation buttons only visible in home tab */
.home-nav-buttons {
  display: none;
}

.home-tab-active .home-nav-buttons {
  display: flex;
}


/* Hide scrollbar for Chrome, Safari and Opera */
.scrollbar-hide::-webkit-scrollbar {
  display: none;
}

/* Hide scrollbar for IE, Edge and Firefox */
.scrollbar-hide {
  -ms-overflow-style: none;  /* IE and Edge */
  scrollbar-width: none;     /* Firefox */
}


    </style>
</head>
<body class="bg-black text-white" data-theme="dark">
    <div id="app" class="min-h-screen">
        <!-- Authentication Modal -->
        <div id="authModal" class="fixed inset-0 bg-black/90 z-[100] flex items-center justify-center hidden">
            <div class="bg-gray-900 p-6 rounded-xl w-full max-w-md mx-4">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold gradient-logo">Picasso</h2>
                    <button onclick="closeAuthModal()" class="p-1 rounded-full hover:bg-gray-700">
                        <i class="fas fa-times text-lg"></i>
                    </button>
                </div>
                
                <!-- Login Form -->
                <div id="loginForm">
                    <h3 class="text-lg font-semibold mb-4">Log in to your account</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-1">Email</label>
                            <input type="email" id="loginEmail" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Password</label>
                            <input type="password" id="loginPassword" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                        </div>
                        <button onclick="login()" class="w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white py-2 rounded-lg font-medium hover:from-pink-600 hover:to-purple-700 transition-all">
                            Log In
                        </button>
                        <div class="text-center text-sm">
                            <a href="#" onclick="showSignupForm()" class="text-pink-400 hover:underline">Don't have an account? Sign up</a>
                        </div>
                    </div>
                </div>
                
                <!-- Signup Form (Initially Hidden) -->
                <div id="signupForm" class="hidden">
                    <h3 class="text-lg font-semibold mb-4">Create an account</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-1">Username</label>
                            <input type="text" id="signupUsername" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Email</label>
                            <input type="email" id="signupEmail" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Password</label>
                            <input type="password" id="signupPassword" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Confirm Password</label>
                            <input type="password" id="signupConfirmPassword" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                        </div>
                        <button onclick="signup()" class="w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white py-2 rounded-lg font-medium hover:from-pink-600 hover:to-purple-700 transition-all">
                            Sign Up
                        </button>
                        <div class="text-center text-sm">
                            <a href="#" onclick="showLoginForm()" class="text-pink-400 hover:underline">Already have an account? Log in</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Messages Panel (Initially Hidden) -->
        <div id="messagesPanel" class="fixed inset-0 bg-black/90 z-[100] flex hidden messages-panel">
            <div class="bg-gray-900 w-full h-full max-w-md border-r border-gray-800">
                <div class="p-4 border-b border-gray-800">
                    <div class="flex justify-between items-center">
                        <h3 class="font-semibold">Messages</h3>
                        <button onclick="closeMessagesPanel()" class="p-1 rounded-full hover:bg-gray-700">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="mt-3">
                        <input type="text" placeholder="Search messages..." class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-pink-500">
                    </div>
                </div>
                <div class="overflow-y-auto" style="height: calc(100% - 80px);">
                    <!-- Chat List -->
                    <div class="chat-item p-3 border-b border-gray-800 cursor-pointer hover:bg-gray-800" onclick="openChat('user1')">
                        <div class="flex items-center">
                            <img src="https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=50&h=50&fit=crop" 
                                alt="User" class="w-12 h-12 rounded-full">
                            <div class="ml-3 flex-1">
                                <div class="flex justify-between">
                                    <span class="font-semibold">@artista_maya</span>
                                    <span class="text-xs text-gray-400">2m</span>
                                </div>
                                <p class="text-sm text-gray-400 truncate">Would love to commission a piece!</p>
                            </div>
                        </div>
                    </div>
                    <div class="chat-item p-3 border-b border-gray-800 cursor-pointer hover:bg-gray-800" onclick="openChat('user2')">
                        <div class="flex items-center">
                            <img src="https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=50&h=50&fit=crop" 
                                alt="User" class="w-12 h-12 rounded-full">
                            <div class="ml-3 flex-1">
                                <div class="flex justify-between">
                                    <span class="font-semibold">@creative_soul</span>
                                    <span class="text-xs text-gray-400">1h</span>
                                </div>
                                <p class="text-sm text-gray-400 truncate">Great job on your latest piece!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="activeChatPanel" class="flex-1 flex flex-col">
                <div class="p-4 border-b border-gray-800 flex items-center">
                    <img src="https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=50&h=50&fit=crop" 
                         alt="User" class="w-10 h-10 rounded-full">
                    <div class="ml-3">
                        <span class="font-semibold" id="activeChatUser">@artista_maya</span>
                        <p class="text-xs text-gray-400">Digital Artist</p>
                    </div>
                </div>
                <div class="flex-1 overflow-y-auto p-4" id="chatMessages">
                    <!-- Chat Messages -->
                    <div class="message-item mb-4">
                        <div class="flex items-start">
                            <img src="https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=30&h=30&fit=crop" 
                                 alt="User" class="w-8 h-8 rounded-full">
                            <div class="ml-2 bg-gray-800 px-4 py-2 rounded-lg rounded-tl-none">
                                <p class="text-sm">Hi there! I love your artwork.</p>
                                <span class="text-xs text-gray-400">10:30 AM</span>
                            </div>
                        </div>
                    </div>
                    <div class="message-item mb-4 flex justify-end">
                        <div class="bg-gradient-to-r from-pink-500 to-purple-600 px-4 py-2 rounded-lg rounded-tr-none">
                            <p class="text-sm">Thank you so much! What can I help you with?</p>
                            <span class="text-xs text-right block">10:32 AM</span>
                        </div>
                    </div>
                    <div class="message-item mb-4">
                        <div class="flex items-start">
                            <img src="https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=30&h=30&fit=crop" 
                                 alt="User" class="w-8 h-8 rounded-full">
                            <div class="ml-2 bg-gray-800 px-4 py-2 rounded-lg rounded-tl-none">
                                <p class="text-sm">Would love to commission a piece from you. What's your rate?</p>
                                <span class="text-xs text-gray-400">10:35 AM</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="p-4 border-t border-gray-800">
                    <div class="flex items-center">
                        <input type="text" placeholder="Type a message..." class="flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                        <button class="ml-2 p-2 bg-pink-500 rounded-lg">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Header -->
        <header class="fixed top-0 left-0 right-0 z-50 bg-black/80 backdrop-blur-md border-b border-gray-800">
            <div class="flex items-center justify-between px-4 py-3">
                <div class="flex items-center space-x-6">
                    <h1 class="text-2xl font-bold gradient-logo">Picasso</h1>
                    <!-- Navigation buttons only shown in home tab -->
                    <div class="hidden md:flex space-x-4 home-nav-buttons">
                        <button class="px-4 py-2 rounded-full action-btn text-sm font-medium hover:scale-105 transition-all nav-filter-btn" data-filter="friends">
                            <i class="fas fa-users mr-2"></i>Friends
                        </button>
                        <button class="px-4 py-2 rounded-full action-btn text-sm font-medium hover:scale-105 transition-all nav-filter-btn" data-filter="artists">
                            <i class="fas fa-palette mr-2"></i>Artists
                        </button>
                        <button class="px-4 py-2 rounded-full action-btn text-sm font-medium hover:scale-105 transition-all nav-filter-btn" data-filter="feed">
                            <i class="fas fa-rss mr-2"></i>Feed
                        </button>
                        <button class="px-4 py-2 rounded-full action-btn text-sm font-medium hover:scale-105 transition-all nav-filter-btn" data-filter="busking">
                            <i class="fas fa-guitar mr-2"></i>Busking
                        </button>

                        <button class="px-4 py-2 rounded-full action-btn text-sm font-medium hover:scale-105 transition-all nav-filter-btn" data-filter="live">
                            <i class="fas fa-circle text-red-500 text-xs mr-2"></i>Live
                        </button>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- Search button -->
                    <button class="p-2 rounded-full action-btn hover:scale-105 transition-all" onclick="toggleSearch()">
                        <i class="fas fa-search text-lg"></i>
                    </button>

                    <!-- Messages button -->
                    <button class="p-2 rounded-full action-btn hover:scale-105 transition-all relative" onclick="openMessagesPanel()">
                        <i class="fas fa-comment-dots text-lg"></i>
                        <span class="notification-badge">2</span>
                    </button>

                    <!-- Favorites button -->
                    <button class="p-2 rounded-full action-btn hover:scale-105 transition-all" onclick="toggleFavorites()">
                        <i class="fas fa-heart text-lg"></i>
                    </button>

                    <!-- Shopping Cart Button -->
                    <button class="p-2 rounded-full action-btn hover:scale-105 transition-all relative" onclick="toggleShoppingCart()">
                        <i class="fas fa-shopping-cart text-lg"></i>
                        <span id="cartCountBadge" class="notification-badge hidden">0</span>
                    </button>
                    
                    <!-- User profile / Login -->
                    <button class="p-2 rounded-full action-btn hover:scale-105 transition-all" onclick="showAuthModal()">
                        <i class="fas fa-user text-lg"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- Search Overlay (Initially Hidden) -->
        <div id="searchOverlay" class="fixed inset-0 bg-black/90 z-[90] flex items-start justify-center pt-20 hidden search-overlay">
            <div class="bg-gray-900 p-6 rounded-xl w-full max-w-2xl mx-4">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">Search</h2>
                    <button onclick="closeSearch()" class="p-1 rounded-full hover:bg-gray-700">
                        <i class="fas fa-times text-lg"></i>
                    </button>
                </div>
                
                <div class="relative mb-6">
                    <i class="fas fa-search absolute top-3 left-3 text-gray-400"></i>
                    <input type="text" id="searchInput" placeholder="Search for artists, artwork, tags..." 
                           class="w-full bg-gray-800 border border-gray-700 rounded-lg pl-10 pr-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                </div>

                <div class="mb-4">
                    <h3 class="text-sm font-medium text-gray-400 mb-2">Filter by Category</h3>
                    <div class="flex flex-wrap">
                        <div class="category-pill active" data-category="all" onclick="filterByCategory('all')">All</div>
                        <div class="category-pill" data-category="painting" onclick="filterByCategory('painting')">Painting</div>
                        <div class="category-pill" data-category="digital" onclick="filterByCategory('digital')">Digital Art</div>
                        <div class="category-pill" data-category="photography" onclick="filterByCategory('photography')">Photography</div>
                        <div class="category-pill" data-category="sculpture" onclick="filterByCategory('sculpture')">Sculpture</div>
                        <div class="category-pill" data-category="music" onclick="filterByCategory('music')">Music</div>
                        <div class="category-pill" data-category="busking" onclick="filterByCategory('busking')">Busking</div>
                    </div>
                </div>

                <div class="mb-4">
                    <h3 class="text-sm font-medium text-gray-400 mb-2">Price Range</h3>
                    <div class="flex items-center space-x-3">
                        <input type="number" placeholder="Min" class="w-24 bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm">
                        <span>-</span>
                        <input type="number" placeholder="Max" class="w-24 bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm">
                        <button class="px-3 py-1 bg-gray-700 rounded-lg text-sm hover:bg-gray-600">Apply</button>
                    </div>
                </div>

                <div>
                    <h3 class="text-sm font-medium text-gray-400 mb-2">Sort By</h3>
                    <select class="bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm w-full">
                        <option value="newest">Newest</option>
                        <option value="popular">Most Popular</option>
                        <option value="price_low">Price: Low to High</option>
                        <option value="price_high">Price: High to Low</option>
                    </select>
                </div>

                <div class="mt-6">
                    <h3 class="text-lg font-semibold mb-4">Results</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <!-- Search results will appear here -->
                        <div class="search-result bg-gray-800 rounded-lg overflow-hidden">
                            <div class="aspect-square bg-gradient-to-br from-purple-900 to-blue-900"></div>
                            <div class="p-2">
                                <p class="text-sm font-medium">Abstract Dreams</p>
                                <div class="flex justify-between items-center">
                                    <span class="text-xs text-gray-400">@artista_maya</span>
                                    <span class="text-xs font-medium">₱8,500</span>
                                </div>
                            </div>
                        </div>
                        <div class="search-result bg-gray-800 rounded-lg overflow-hidden">
                            <div class="aspect-square bg-gradient-to-br from-green-900 to-teal-900"></div>
                            <div class="p-2">
                                <p class="text-sm font-medium">Ocean Melody</p>
                                <div class="flex justify-between items-center">
                                    <span class="text-xs text-gray-400">@creative_soul</span>
                                    <span class="text-xs font-medium">₱12,000</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Shopping Cart Panel (Initially Hidden) -->
        <div id="shoppingCartPanel" class="fixed inset-0 bg-black/90 z-[90] flex items-start justify-center pt-20 hidden shopping-cart-panel">
            <div class="bg-gray-900 p-6 rounded-xl w-full max-w-2xl mx-4">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">Shopping Cart</h2>
                    <button onclick="closeShoppingCart()" class="p-1 rounded-full hover:bg-gray-700">
                        <i class="fas fa-times text-lg"></i>
                    </button>
                </div>
                
                <div id="cartEmptyMessage" class="py-8 text-center text-gray-400">
                    <i class="fas fa-shopping-cart text-3xl mb-3"></i>
                    <p>Your cart is empty</p>
                </div>
                
                <div id="cartItems" class="hidden">
                    <div class="max-h-96 overflow-y-auto">
                        <div class="space-y-4" id="cartItemsList">
                            <!-- Cart items will be added here dynamically -->
                        </div>
                    </div>
                    
                    <div class="mt-6 border-t border-gray-800 pt-4">
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm text-gray-400">Subtotal</span>
                            <span id="cartSubtotal" class="font-medium">₱0</span>
                        </div>
                        <div class="flex justify-between items-center mb-4">
                            <span class="text-sm text-gray-400">Shipping</span>
                            <span class="font-medium">₱150</span>
                        </div>
                        <div class="flex justify-between items-center mb-6 text-lg font-bold">
                            <span>Total</span>
                            <span id="cartTotal">₱150</span>
                        </div>
                        
                        <button onclick="proceedToCheckout()" class="w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white py-3 rounded-lg font-medium hover:from-pink-600 hover:to-purple-700 transition-all">
                            Proceed to Checkout
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Checkout Panel (Initially Hidden) -->
        <div id="checkoutPanel" class="fixed inset-0 bg-black/90 z-[90] flex items-start justify-center pt-20 hidden checkout-panel">
            <div class="bg-gray-900 p-6 rounded-xl w-full max-w-2xl mx-4">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">Checkout</h2>
                    <button onclick="backToCart()" class="p-1 rounded-full hover:bg-gray-700">
                        <i class="fas fa-arrow-left text-lg"></i>
                    </button>
                </div>
                
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-3">Shipping Details</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-1">First Name</label>
                            <input type="text" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Last Name</label>
                            <input type="text" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                        </div>
                    </div>
                    <div class="mt-3">
                        <label class="block text-sm font-medium mb-1">Address</label>
                        <input type="text" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                    </div>
                    <div class="grid grid-cols-2 gap-4 mt-3">
                        <div>
                            <label class="block text-sm font-medium mb-1">City</label>
                            <input type="text" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Postal Code</label>
                            <input type="text" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                        </div>
                    </div>
                    <div class="mt-3">
                        <label class="block text-sm font-medium mb-1">Phone Number</label>
                        <input type="text" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                    </div>
                </div>
                
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-3">Order Summary</h3>
                    <div class="bg-gray-800 rounded-lg p-4">
                        <div id="checkoutItemsList" class="space-y-2 mb-4">
                            <!-- Checkout items summary will be added here -->
                        </div>
                        <div class="border-t border-gray-700 pt-3">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-sm text-gray-400">Subtotal</span>
                                <span id="checkoutSubtotal" class="font-medium">₱0</span>
                            </div>
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-sm text-gray-400">Shipping</span>
                                <span class="font-medium">₱150</span>
                            </div>
                            <div class="flex justify-between items-center text-lg font-bold">
                                <span>Total</span>
                                <span id="checkoutTotal">₱150</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-3">Payment Method</h3>
                    <div class="grid grid-cols-3 gap-3 mb-4">
                        <button class="p-3 bg-gray-800 rounded-lg border border-pink-500 flex items-center justify-center">
                            <i class="fab fa-cc-visa text-2xl"></i>
                        </button>
                        <button class="p-3 bg-gray-800 rounded-lg border border-gray-700 flex items-center justify-center">
                            <i class="fab fa-cc-mastercard text-2xl"></i>
                        </button>
                        <button class="p-3 bg-gray-800 rounded-lg border border-gray-700 flex items-center justify-center">
                            <i class="fab fa-paypal text-2xl"></i>
                        </button>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Card Number</label>
                        <input type="text" placeholder="1234 5678 9012 3456" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                    </div>
                    <div class="grid grid-cols-2 gap-4 mt-3">
                        <div>
                            <label class="block text-sm font-medium mb-1">Expiry Date</label>
                            <input type="text" placeholder="MM/YY" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">CVC</label>
                            <input type="text" placeholder="123" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                        </div>
                    </div>
                    
                    <button onclick="completeOrder()" class="w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white py-3 rounded-lg font-medium hover:from-pink-600 hover:to-purple-700 transition-all mt-6">
                        Complete Order
                    </button>
                </div>
            </div>
        </div>

        <!-- Favorites Collection (Initially Hidden) -->
        <div id="favoritesPanel" class="fixed inset-0 bg-black/90 z-[90] flex items-start justify-center pt-20 hidden favorites-panel">
            <div class="bg-gray-900 p-6 rounded-xl w-full max-w-2xl mx-4">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">Favorites Collection</h2>
                    <button onclick="closeFavorites()" class="p-1 rounded-full hover:bg-gray-700">
                        <i class="fas fa-times text-lg"></i>
                    </button>
                </div>
                
                <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                    <div class="favorite-item bg-gray-800 rounded-lg overflow-hidden">
                        <div class="aspect-square bg-gradient-to-br from-purple-900 to-blue-900 relative">
                            <button class="absolute top-2 right-2 p-1 bg-black/50 rounded-full" onclick="removeFromFavorites(this)">
                                <i class="fas fa-heart text-pink-500"></i>
                            </button>
                        </div>
                        <div class="p-2">
                            <p class="text-sm font-medium">Abstract Dreams</p>
                            <div class="flex justify-between items-center">
                                <span class="text-xs text-gray-400">@artista_maya</span>
                                <span class="text-xs font-medium">₱8,500</span>
                            </div>
                        </div>
                    </div>
                    <div class="favorite-item bg-gray-800 rounded-lg overflow-hidden">
                        <div class="aspect-square bg-gradient-to-br from-green-900 to-teal-900 relative">
                            <button class="absolute top-2 right-2 p-1 bg-black/50 rounded-full" onclick="removeFromFavorites(this)">
                                <i class="fas fa-heart text-pink-500"></i>
                            </button>
                        </div>
                        <div class="p-2">
                            <p class="text-sm font-medium">Ocean Melody</p>
                            <div class="flex justify-between items-center">
                                <span class="text-xs text-gray-400">@creative_soul</span>
                                <span class="text-xs font-medium">₱12,000</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="pt-20 pb-20">
            <!-- Main Navigation Buttons (Only visible in home tab) -->
            <div class="py-3 px-4 border-b border-gray-800 mb-4 home-nav-buttons">
                <div class="flex space-x-3 min-w-max">
                    <button class="px-4 py-2 rounded-full action-btn text-sm font-medium hover:scale-105 transition-all nav-filter-btn active" data-filter="friends">
                        <i class="fas fa-users mr-2"></i>Friends
                    </button>
                    <button class="px-4 py-2 rounded-full action-btn text-sm font-medium hover:scale-105 transition-all nav-filter-btn" data-filter="artists">
                        <i class="fas fa-palette mr-2"></i>Artists
                    </button>
                    <button class="px-4 py-2 rounded-full action-btn text-sm font-medium hover:scale-105 transition-all nav-filter-btn" data-filter="feed">
                        <i class="fas fa-rss mr-2"></i>Feed
                    </button>
                    <button class="px-4 py-2 rounded-full action-btn text-sm font-medium hover:scale-105 transition-all nav-filter-btn" data-filter="busking">
                        <i class="fas fa-guitar mr-2"></i>Busking
                    </button>
                </div>
            </div>
            
    <!-- Home Tab Content -->
    <div id="home-content" class="relative tab-content home-tab-active h-[calc(100vh-128px)] pb-[20px] pt-[20px]">
        <div class="block max-w-md mx-auto  h-full">
            <div class="scrollbar-hide h-full overflow-y-auto snap-y snap-mandatory space-y-4 h-[calc(100vh-128px)]">
            <!-- Video Card 1 -->
            <div class="snap-start w-full h-full relative">
            <div class="relative w-full h-full bg-gray-900" data-category="painting">
                <div class="w-full h-full bg-gradient-to-br from-purple-900 to-blue-900 flex items-center justify-center">
                  <i class="fas fa-play text-6xl text-white/50 cursor-pointer"></i>
                   <!--container for product elements--> 
                    <div class="absolute left-4 bottom-4 flex flex-col items-start space-y-3">
                        <!-- Product Tag -->
                          <div class="product-tag bottom-4 rounded-full px-3 py-1 text-xs cursor-pointer flex items-center">
                            <div onclick="viewLinkedProducts(this)">
                                <i class="fas fa-shopping-bag mr-1"></i>
                                Oil Painting - ₱8,500
                            </div>
                            <button class="ml-2 add-to-cart-btn p-1 bg-pink-500 rounded-full" 
                                    data-product="Abstract Dreams Oil Painting" 
                                    data-price="8500"
                                    data-image="https://via.placeholder.com/100">
                                <i class="fas fa-cart-plus text-xs"></i>
                            </button>
                        </div>
                        <!-- 2 Products Linked Button -->
                        <div class="flex items-center space-x-2">
                            <button class="bg-gray-800 p-1 rounded-lg" onclick="viewLinkedProducts(this)">
                                <i class="fas fa-shopping-cart text-yellow-400 text-lg mr-1"></i>
                                <span class="text-xs text-gray-300">2 products linked</span>
                            </button>
                        </div>
                        <!--maya's info-->
                        <div class="w-full pr-6">
                            <div class="flex items-center justify-between mb-2">
                                <div class="flex items-center space-x-3">
                                    <img src="https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=50&h=50&fit=crop" 
                                         alt="Artist" class="w-10 h-10 rounded-full">
                                    <div>
                                        <div class="flex items-center space-x-2">
                                            <span class="font-semibold cursor-pointer" onclick="viewArtistPortfolio('artista_maya')">@artista_maya</span>
                                            <button class="follow-btn bg-gradient-to-r from-pink-500 to-purple-600 text-white px-3 py-1 rounded-full text-xs font-medium hover:from-pink-600 hover:to-purple-700 transition-all" onclick="toggleFollow(this)">
                                                Follow
                                            </button>
                                        </div>
                                        <div class="text-sm text-gray-400">Digital Artist</div>
                                    </div>
                                </div>
                            </div>
                            <p class="text-sm text-gray-300">Creating magic with colors ✨ #art #painting #creative</p>
                            
                    </div>
              </div>           
                        <!-- TikTok-style interaction buttons on right side -->
                        <div class="absolute right-3 top-1/2 -translate-y-1/2 flex flex-col items-center space-y-3">
                            <!-- Brush button -->
                            <div class="text-center">
                                <button class="action-btn p-2 sm:p-3 md:p-4 rounded-full bg-white/10 backdrop-blur hover:scale-105 transition-all brush-btn" onclick="toggleBrush(this)" data-count="2100">
                                    <i class="fas fa-paint-brush text-xl text-gray-400"></i>
                                </button>
                                <div class="text-xs text-gray-400 brush-count">2.1K</div>
                            </div>
                            
                            <!-- Comment button -->
                            <div class="text-center">
                                <button  class="action-btn p-2 sm:p-3 md:p-4 rounded-full bg-white/10 backdrop-blur hover:scale-105 transition-all comment-btn" onclick="toggleComments(this)" data-count="89">
                                    <i class="fas fa-comment text-xl"></i>
                                </button>
                                <div class="text-xs text-gray-400 comment-count">89</div>
                            </div>
                            
                            <!-- Bid Button (yellow if auction available) -->
                            <div class="text-center">
                                <button class="action-btn p-2 sm:p-3 md:p-4 rounded-full bg-white/10 backdrop-blur hover:scale-105 transition-all bid-btn" onclick="showBidModal(this)" data-auction="true">
                                    <i class="fas fa-gavel text-xl bid-available"></i>
                                </button>
                                <div class="text-xs text-gray-400">Bid</div>
                            </div>
                            
                            <!-- Tip Button -->
                            <div class="text-center">
                                <button class="action-btn p-2 sm:p-3 md:p-4 rounded-full bg-white/10 backdrop-blur hover:scale-105 transition-all tip-btn" onclick="showTipModal(this)" data-artist="@artista_maya">
                                    <i class="fas fa-coins text-xl text-gray-400"></i>
                                </button>
                                <div class="text-xs text-gray-400">Tip</div>
                            </div>
                            <!-- Share button -->
                            <div class="text-center">
                                <button class="action-btn p-2 sm:p-3 md:p-4 rounded-full bg-white/10 backdrop-blur hover:scale-105 transition-all share-btn" onclick="shareVideo(this)" data-count="34">
                                    <i class="fas fa-share text-xl"></i>
                                </button>
                                <div class="text-xs text-gray-400 share-count">34</div>
                            </div>
                        </div>
                             <!-- Comments Sidebar (Hidden off-screen by default) -->
                             <div class="comments-section absolute top-0 right-0 h-full w-[350px] bg-gray-800 transform translate-x-full transition-transform duration-300 ease-in-out p-4 shadow-lg">
                                <div class="max-h-[80%] overflow-y-auto space-y-2 mb-3">
                                    <div class="flex items-start space-x-2">
                                        <img src="https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=30&h=30&fit=crop" alt="User" class="w-6 h-6 rounded-full">
                                        <div>
                                            <span class="text-white text-sm font-medium">@user1</span>
                                            <p class="text-gray-300 text-sm">Amazing artwork! 🎨</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start space-x-2">
                                        <img src="https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=30&h=30&fit=crop" alt="User" class="w-6 h-6 rounded-full">
                                        <div>
                                            <span class="text-white text-sm font-medium">@user2</span>
                                            <p class="text-gray-300 text-sm">Love the colors!</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <input type="text" placeholder="Add a comment..." class="flex-1 bg-gray-700 text-white px-3 py-2 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-pink-500 comment-input">
                                    <button class="bg-pink-500 text-white px-4 py-2 rounded-full text-sm hover:bg-pink-600 transition-colors" onclick="addComment(this)">Post</button>
                                </div>
                                <button onclick="toggleComments(this)" class="absolute top-4 right-4 text-white hover:text-pink-400">
                                    <i class="fas fa-times text-xl"></i>
                                </button>
                            </div>

                        </div>
                    </div>
            </div>
                    <!-- Video Card 2 (Busking Category) -->
                    <div class="snap-start relative w-full h-full">
                    <div class="relative flex w-full h-full bg-gray-900 overflow-hidden busking-item" data-category="busking">
                        <div class="relative w-full h-full bg-gradient-to-br from-green-900 to-teal-900 flex items-center justify-center relative">
                            <i class="fas fa-play text-6xl text-white/50 cursor-pointer"></i>
                            <!-- Live Badge -->
                            <div class="absolute top-6 left-4 live-badge px-3 py-1 rounded-full text-xs font-bold">
                                <i class="fas fa-circle text-xs mr-1"></i>LIVE
                            </div>
                            <!--container for product elements-->
                            <div class="absolute left-4 bottom-4 flex flex-col items-start space-y-3">
                                <!-- Product Tag -->
                                <div class="product-tag rounded-full px-6 py-2 text-xs cursor-pointer flex items-center bg-black/70 text-white">
                                    <div onclick="viewLinkedProducts(this)">
                                        <i class="fas fa-music mr-1"></i>
                                        Guitar Session - ₱50/song
                                    </div>
                                    <button class="ml-2 add-to-cart-btn p-1 bg-pink-500 rounded-full" 
                                            data-product="Guitar Session" 
                                            data-price="50"
                                            data-image="https://via.placeholder.com/100">
                                        <i class="fas fa-cart-plus text-xs text-white"></i>
                                    </button>
                                </div>
                                <!--Guitar Master's Info-->
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center space-x-3">
                                            <img src="https://images.pexels.com/photos/1043471/pexels-photo-1043471.jpeg?auto=compress&cs=tinysrgb&w=50&h=50&fit=crop" 
                                                 alt="Musician" class="w-10 h-10 rounded-full">
                                            <div>
                                                <div class="flex items-center space-x-2">
                                                    <span class="font-semibold">@guitar_master</span>
                                                    <button class="follow-btn bg-gradient-to-r from-pink-500 to-purple-600 text-white px-3 py-1 rounded-full text-xs font-medium hover:from-pink-600 hover:to-purple-700 transition-all" onclick="toggleFollow(this)">
                                                        Follow
                                                    </button>
                                                </div>
                                                <div class="text-sm text-gray-400">Street Musician</div>
                                            </div>
                                        </div>
                                    </div>
                                    <p class="text-sm text-gray-300">Live guitar session! Request your favorite songs 🎸 #music #live #guitar</p>
                            </div>
                        </div>
                        </div>
                        <div class="absolute right-3 top-1/2 -translate-y-1/2 flex flex-col items-center space-y-3">
                            <div class="text-center">
                                <button class="action-btn p-2 sm:p-3 md:p-4 rounded-full bg-white/10 backdrop-blur hover:scale-105 transition-all brush-btn" onclick="toggleBrush(this)" data-count="5700">
                                    <i class="fas fa-paint-brush text-xl text-gray-400"></i>
                                </button>
                                <div class="text-xs text-gray-400 brush-count">5.7K</div>
                            </div>
                            
                            <div class="text-center">
                                <button class="action-btn p-2 sm:p-3 md:p-4 rounded-full bg-white/10 backdrop-blur hover:scale-105 transition-all brush-btn" onclick="toggleComments(this)" data-count="234">
                                    <i class="fas fa-comment text-xl"></i>
                                </button>
                                <div class="text-xs text-gray-400 comment-count">234</div>
                            </div>
                            
                            <div class="text-center">
                                <button class="action-btn p-2 sm:p-3 md:p-4 rounded-full bg-white/10 backdrop-blur hover:scale-105 transition-all brush-btn" onclick="showBidModal(this)" data-auction="false">
                                    <i class="fas fa-gavel text-xl text-gray-400"></i>
                                </button>
                                <div class="text-xs text-gray-400">Bid</div>
                            </div>
                            
                            <!-- Tip Button for Busking (Yellow when busking is active) -->
                            <div class="text-center">
                                <button class="action-btn p-2 sm:p-3 md:p-4 rounded-full bg-white/10 backdrop-blur hover:scale-105 transition-all brush-btn" onclick="showTipModal(this)" data-artist="@guitar_master">
                                    <i class="fas fa-coins text-xl tip-available"></i>
                                </button>
                                <div class="text-xs text-gray-400">Tip</div>
                            </div>
                            
                            <div class="text-center">
                                <button class="action-btn p-2 sm:p-3 md:p-4 rounded-full bg-white/10 backdrop-blur hover:scale-105 transition-all brush-btn" onclick="shareVideo(this)" data-count="156">
                                    <i class="fas fa-share text-xl"></i>
                                </button>
                                <div class="text-xs text-gray-400 share-count">156</div>
                            </div>
                        </div>
                            <!-- Comments Section (Hidden by default) -->
                            <div class="comments-section absolute top-0 right-0 h-full w-[320px] bg-gray-800 transform translate-x-full transition-transform duration-300 ease-in-out p-4 shadow-lg z-30">
                                <div class="max-h-[80%] overflow-y-auto space-y-2 mb-3">                        
                                    <div class="flex items-start space-x-2">
                                        <img src="https://images.pexels.com/photos/1043471/pexels-photo-1043471.jpeg?auto=compress&cs=tinysrgb&w=30&h=30&fit=crop" alt="User" class="w-6 h-6 rounded-full">
                                        <div>
                                            <span class="text-white text-sm font-medium">@fan1</span>
                                            <p class="text-gray-300 text-sm">Great performance! 🎸</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <input type="text" placeholder="Add a comment..." class="flex-1 bg-gray-700 text-white px-3 py-2 rounded-full text-sm focus:outline-none focus:ring-2 focus:ring-pink-500 comment-input">
                                    <button class="bg-pink-500 text-white px-4 py-2 rounded-full text-sm hover:bg-pink-600 transition-colors" onclick="addComment(this)">Post</button>
                                </div>
                                <button onclick="toggleComments(this)" class="absolute top-4 right-4 text-white hover:text-pink-400">
                                    <i class="fas fa-times text-xl"></i>
                                </button>
                            </div>
                    
                    </div>
                    </div>
                    </div>
                  </div>
                
                  <!-- Shop Tab Content -->
            <div id="shop-content" class="tab-content hidden pb-24">
                <!-- Top Navigation -->
                <div class="flex justify-center space-x-4 px-4 mb-6">
                    <button class="top-nav-item px-4 py-2 rounded-full text-sm font-medium hover:scale-105 transition-all">
                        <i class="fas fa-ticket-alt mr-2"></i>Voucher
                    </button>
                    <button class="top-nav-item px-4 py-2 rounded-full text-sm font-medium hover:scale-105 transition-all">
                        <i class="fas fa-box mr-2"></i>Orders
                    </button>
                    <button class="top-nav-item px-4 py-2 rounded-full text-sm font-medium hover:scale-105 transition-all">
                        <i class="fas fa-credit-card mr-2"></i>Payment
                    </button>
                </div>

                <!-- Shop Tabs -->
                <div class="flex justify-center mb-6">
                    <div class="flex bg-gray-800 rounded-full p-1">
                        <button id="marketplace-tab" class="tab-active px-6 py-2 rounded-full text-sm font-medium transition-all">
                            Marketplace
                        </button>
                        <button id="myshop-tab" class="tab-inactive px-6 py-2 rounded-full text-sm font-medium transition-all">
                            My Shop
                        </button>
                    </div>
                </div>

                <!-- Search Bar -->
                <div class="px-4 mb-6">
                    <div class="relative">
                        <input type="text" placeholder="Search products..." 
                               class="w-full bg-gray-800 border border-gray-700 rounded-full px-4 py-3 pl-12 text-white placeholder-gray-400 focus:outline-none focus:border-purple-500">
                        <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                    </div>
                </div>

                <!-- Marketplace Content -->
                <div id="marketplace-content" class="shop-tab-content">
                    <!-- Categories -->
                    <div class="mb-6">
                        <div class="relative">
                            
                            <!-- Categories Container -->
                            <div class="categories-container overflow-x-auto scrollbar-hide px-5" id="categoriesContainer">
                                <div class="flex space-x-2 pb-2 pt-2 min-w-max">
                                    <button class="category-btn bg-purple-600 text-white px-4 py-2 rounded-full text-sm whitespace-nowrap transition-all hover:scale-105" data-category="all">All</button>
                                    <button class="category-btn bg-gray-700 text-gray-300 px-4 py-2 rounded-full text-sm whitespace-nowrap transition-all hover:scale-105" data-category="digital-art">Digital Art</button>
                                    <button class="category-btn bg-gray-700 text-gray-300 px-4 py-2 rounded-full text-sm whitespace-nowrap transition-all hover:scale-105" data-category="painting">Painting</button>
                                    <button class="category-btn bg-gray-700 text-gray-300 px-4 py-2 rounded-full text-sm whitespace-nowrap transition-all hover:scale-105" data-category="sculptures">Sculptures</button>
                                    <button class="category-btn bg-gray-700 text-gray-300 px-4 py-2 rounded-full text-sm whitespace-nowrap transition-all hover:scale-105" data-category="busking">Busking</button>
                                    <button class="category-btn bg-gray-700 text-gray-300 px-4 py-2 rounded-full text-sm whitespace-nowrap transition-all hover:scale-105" data-category="art-materials">Art Materials</button>
                                    <div class="relative">
                                        <button class="category-btn bg-gray-700 text-gray-300 px-4 py-2 rounded-full text-sm whitespace-nowrap flex items-center space-x-2 transition-all hover:scale-105" data-category="services" onclick="toggleServicesDropdown()">
                                            <span>Services</span>
                                            <i class="fas fa-chevron-down text-sm"></i>
                                        </button>
                                    </div>

                                    <div class="relative">
                                        <button type="button" onclick="toggleInstrumentsDropdown()" class="category-btn bg-gray-700 text-gray-300 px-4 py-2 rounded-full text-sm whitespace-nowrap flex items-center space-x-2 transition-all hover:scale-105" data-category="instruments">
                                          <span>Musical Instruments</span>
                                          <i class="fas fa-chevron-down text-sm"></i>
                                        </button>
                                      </div>
                                      
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Products Grid -->
                     <!-- px-4 if cp, sm(small), md(medium), xl(xtralarge)-->
                    <div class="px-4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-5 gap-4 pb-24">
                        <!-- Product Card 1 -->
                        <div class="bg-gray-900 rounded-xl overflow-hidden product-card" data-category="digital-art">
                            <div class="aspect-square bg-gradient-to-br from-purple-600 to-pink-600 relative">
                                <img src="https://images.pexels.com/photos/1266808/pexels-photo-1266808.jpeg?auto=compress&cs=tinysrgb&w=300&h=300&fit=crop" 
                                     alt="Digital Art" class="w-full h-full object-cover">
                                <div class="absolute top-2 right-2 bg-green-500 text-white px-2 py-1 rounded-full text-xs">
                                    <i class="fas fa-gavel mr-1"></i>Auction
                                </div>
                            </div>
                            <div class="p-3">
                                <h3 class="font-semibold text-sm mb-1">Digital Portrait NFT</h3>
                                <p class="text-gray-400 text-xs mb-2">by @artista_maya</p>
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-purple-400 font-bold">₱12,500.00</span>
                                    <span class="text-xs text-gray-500">23 bids</span>
                                </div>
                                <div class="flex space-x-2">
                                    <button class="buy-btn flex-1 py-2 rounded-lg text-sm font-medium">
                                        <i class="fas fa-shopping-cart mr-1"></i>Buy Now
                                    </button>
                                    <button class="bg-gray-700 px-3 py-2 rounded-lg" onclick="openChat()">
                                        <i class="fas fa-comment text-sm"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Product Card 2 -->
                        <div class="bg-gray-900 rounded-xl overflow-hidden product-card" data-category="painting">
                            <div class="aspect-square bg-gradient-to-br from-blue-600 to-teal-600 relative">
                                <img src="https://images.pexels.com/photos/1183992/pexels-photo-1183992.jpeg?auto=compress&cs=tinysrgb&w=300&h=300&fit=crop" 
                                     alt="Oil Painting" class="w-full h-full object-cover">
                                <div class="absolute top-2 right-2 bg-blue-500 text-white px-2 py-1 rounded-full text-xs">
                                    Fixed Price
                                </div>
                            </div>
                            <div class="p-3">
                                <h3 class="font-semibold text-sm mb-1">Oil Painting - Sunset</h3>
                                <p class="text-gray-400 text-xs mb-2">by @painter_pro</p>
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-purple-400 font-bold">₱8,500.00</span>
                                    <span class="text-xs text-green-500">In Stock</span>
                                </div>
                                <div class="flex space-x-2">
                                    <button class="buy-btn flex-1 py-2 rounded-lg text-sm font-medium">
                                        <i class="fas fa-shopping-cart mr-1"></i>Buy Now
                                    </button>
                                    <button class="bg-gray-700 px-3 py-2 rounded-lg" onclick="openChat()">
                                        <i class="fas fa-comment text-sm"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Busking Service -->
                        <div class="bg-gray-900 rounded-xl overflow-hidden product-card" data-category="busking">
                            <div class="aspect-square bg-gradient-to-br from-yellow-600 to-orange-600 relative">
                                <img src="https://images.pexels.com/photos/1407322/pexels-photo-1407322.jpeg?auto=compress&cs=tinysrgb&w=300&h=300&fit=crop" 
                                     alt="Street Guitar Performance" class="w-full h-full object-cover">
                                <div class="absolute top-2 right-2 live-badge px-2 py-1 rounded-full text-xs">
                                    <i class="fas fa-circle text-xs mr-1"></i>LIVE
                                </div>
                            </div>
                            <div class="p-3">
                                <h3 class="font-semibold text-sm mb-1">Street Guitar Performance</h3>
                                <p class="text-gray-400 text-xs mb-2">by @guitar_master</p>
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-purple-400 font-bold">₱50/song</span>
                                    <span class="text-xs text-yellow-500">Busking</span>
                                </div>
                                <div class="flex space-x-2">
                                    <button class="buy-btn flex-1 py-2 rounded-lg text-sm font-medium">
                                        <i class="fas fa-video mr-1"></i>Join Live
                                    </button>
                                    <button class="bg-gray-700 px-3 py-2 rounded-lg" onclick="openChat()">
                                        <i class="fas fa-comment text-sm"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Service Cards -->
                        <div class="bg-gray-900 rounded-xl overflow-hidden product-card" data-category="services" data-subcategory="graphic-design">
                            <div class="aspect-square bg-gradient-to-br from-indigo-600 to-purple-600 relative">
                                <img src="https://images.pexels.com/photos/196644/pexels-photo-196644.jpeg?auto=compress&cs=tinysrgb&w=300&h=300&fit=crop" 
                                     alt="Graphic Design Service" class="w-full h-full object-cover">
                            </div>
                            <div class="p-3">
                                <h3 class="font-semibold text-sm mb-1">Logo & Brand Design</h3>
                                <p class="text-gray-400 text-xs mb-2">by @designer_pro</p>
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-purple-400 font-bold">₱2,500.00</span>
                                    <span class="text-xs text-green-500">Available</span>
                                </div>
                                <div class="flex space-x-2">
                                    <button class="buy-btn flex-1 py-2 rounded-lg text-sm font-medium">
                                        <i class="fas fa-shopping-cart mr-1"></i>Buy Now
                                    </button>
                                    <button class="bg-gray-700 px-3 py-2 rounded-lg" onclick="openChat()">
                                        <i class="fas fa-comment text-sm"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-900 rounded-xl overflow-hidden product-card" data-category="services" data-subcategory="commissions">
                            <div class="aspect-square bg-gradient-to-br from-pink-600 to-red-600 relative">
                                <img src="https://images.pexels.com/photos/1266808/pexels-photo-1266808.jpeg?auto=compress&cs=tinysrgb&w=300&h=300&fit=crop" 
                                     alt="Art Commission" class="w-full h-full object-cover">
                            </div>
                            <div class="p-3">
                                <h3 class="font-semibold text-sm mb-1">Custom Portrait Commission</h3>
                                <p class="text-gray-400 text-xs mb-2">by @portrait_artist</p>
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-purple-400 font-bold">₱3,500.00</span>
                                    <span class="text-xs text-green-500">Available</span>
                                </div>
                                <div class="flex space-x-2">
                                    <button class="buy-btn flex-1 py-2 rounded-lg text-sm font-medium">
                                        <i class="fas fa-shopping-cart mr-1"></i>Buy Now
                                    </button>
                                    <button class="bg-gray-700 px-3 py-2 rounded-lg" onclick="openChat()">
                                        <i class="fas fa-comment text-sm"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="bg-gray-900 rounded-xl overflow-hidden product-card" data-category="services" data-subcategory="tattoo">
                            <div class="aspect-square bg-gradient-to-br from-gray-600 to-black relative">
                                <img src="https://images.pexels.com/photos/1319460/pexels-photo-1319460.jpeg?auto=compress&cs=tinysrgb&w=300&h=300&fit=crop" 
                                     alt="Tattoo Service" class="w-full h-full object-cover">
                            </div>
                            <div class="p-3">
                                <h3 class="font-semibold text-sm mb-1">Custom Tattoo Design</h3>
                                <p class="text-gray-400 text-xs mb-2">by @ink_master</p>
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-purple-400 font-bold">₱5,000.00</span>
                                    <span class="text-xs text-green-500">Available</span>
                                </div>
                                <div class="flex space-x-2">
                                    <button class="buy-btn flex-1 py-2 rounded-lg text-sm font-medium">
                                        <i class="fas fa-shopping-cart mr-1"></i>Buy Now
                                    </button>
                                    <button class="bg-gray-700 px-3 py-2 rounded-lg" onclick="openChat()">
                                        <i class="fas fa-comment text-sm"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Example Service Cards for Demo Purposes -->
                        <div class="bg-gray-900 rounded-xl overflow-hidden product-card" data-category="services" data-subcategory="guitar-luthier">
                            <div class="aspect-square bg-gradient-to-br from-gray-600 to-black relative">
                                <img src="https://hub.yamaha.com/wp-content/uploads/2015/05/DSC00195-min-1-scaled.jpg" 
                                     alt="Guitar Luthier Service" class="w-full h-full object-cover">
                            </div>
                            <div class="p-3">
                                <h3 class="font-semibold text-sm mb-1">Guitar Luthier Services</h3>
                                <p class="text-gray-400 text-xs mb-2">by @craftser</p>
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-purple-400 font-bold">₱2,000 - ₱20,000</span>
                                    <span class="text-xs text-green-500">Available</span>
                                </div>
                                <div class="flex space-x-2">
                                    <button class="buy-btn flex-1 py-2 rounded-lg text-sm font-medium" onclick="openLuthierForm()">
                                        <i class="fas fa-guitar mr-1"></i>Request Service
                                    </button>
                                    <button class="bg-gray-700 px-3 py-2 rounded-lg" onclick="openChat()">
                                        <i class="fas fa-comment text-sm"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="bg-gray-900 rounded-xl overflow-hidden product-card" data-category="services" data-subcategory="guitar-luthier">
                            <div class="aspect-square bg-gradient-to-br from-gray-600 to-black relative">
                                <img src="https://m.media-amazon.com/images/I/71Kxqh0AisL._AC_SL1500_.jpg" 
                                     alt="Violin Luthier Service" class="w-full h-full object-cover">
                            </div>
                            <div class="p-3">
                                <h3 class="font-semibold text-sm mb-1">Violin Luthier Services</h3>
                                <p class="text-gray-400 text-xs mb-2">by @violinist</p>
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-purple-400 font-bold">₱3,000 - ₱18,000</span>
                                    <span class="text-xs text-green-500">Available</span>
                                </div>
                                <div class="flex space-x-2">
                                    <button class="buy-btn flex-1 py-2 rounded-lg text-sm font-medium">
                                        <i class="fas fa-violin mr-1"></i>Request Service
                                    </button>
                                    <button class="bg-gray-700 px-3 py-2 rounded-lg" onclick="openChat()">
                                        <i class="fas fa-comment text-sm"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="bg-gray-900 rounded-xl overflow-hidden product-card" data-category="services" data-subcategory="guitar-luthier">
                            <div class="aspect-square bg-gradient-to-br from-gray-600 to-black relative">
                                <img src="https://www.solowayschool.com/wp-content/uploads/2024/07/Cello-1024x1024.webp" 
                                     alt="Cello Luthier Service" class="w-full h-full object-cover">
                            </div>
                            <div class="p-3">
                                <h3 class="font-semibold text-sm mb-1">Cello Luthier Services</h3>
                                <p class="text-gray-400 text-xs mb-2">by @repair_master</p>
                                <div class="flex items-center justify-between mb-3">
                                    <span class="text-purple-400 font-bold">₱4,000 - ₱22,000</span>
                                    <span class="text-xs text-green-500">Available</span>
                                </div>
                                <div class="flex space-x-2">
                                    <button class="buy-btn flex-1 py-2 rounded-lg text-sm font-medium">
                                        <i class="fas fa-music mr-1"></i>Request Service
                                    </button>
                                    <button class="bg-gray-700 px-3 py-2 rounded-lg" onclick="openChat()">
                                        <i class="fas fa-comment text-sm"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- My Shop Content -->
                <div id="myshop-content" class="shop-tab-content hidden">
                    <!-- Shop Stats -->
                    <div class="px-4 mb-6">
                        <div class="bg-gray-900 rounded-xl p-4">
                            <div class="flex items-center justify-between mb-4">
                                <h2 class="text-lg font-bold">My Shop Dashboard</h2>
                                <div class="text-right">
                                    <div class="text-2xl font-bold text-green-400">₱8,750.50</div>
                                    <div class="text-xs text-gray-400">Available Balance</div>
                                </div>
                            </div>
                            <div class="grid grid-cols-3 gap-4 text-center">
                                <div>
                                    <div class="text-xl font-bold text-purple-400 stat-number">47</div>
                                    <div class="text-xs text-gray-400">Products</div>
                                </div>
                                <div>
                                    <div class="text-xl font-bold text-blue-400">156</div>
                                    <div class="text-xs text-gray-400">Orders</div>
                                </div>
                                <div>
                                    <div class="text-xl font-bold text-green-400">₱12,450</div>
                                    <div class="text-xs text-gray-400">Total Sales</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="px-4 mb-6">
                        <div class="grid grid-cols-2 gap-4">
                            <button onclick="openAddProductModal()" class="bg-gradient-to-r from-purple-600 to-blue-600 p-4 rounded-xl text-center">
                                <i class="fas fa-plus text-2xl mb-2"></i>
                                <div class="font-semibold">Add Product</div>
                            </button>
                            <button class="bg-gray-800 p-4 rounded-xl text-center">
                                <i class="fas fa-chart-line text-2xl mb-2"></i>
                                <div class="font-semibold">Analytics</div>
                            </button>
                        </div>
                    </div>

                    <!-- My Products Grid -->
                    <div class="px-4 mb-6">
                        <div class="products-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 15px; min-height: 200px;">
                            <!-- Sample user products -->
                            <div class="product-card" style="background: #1a1a1a; border-radius: 12px; overflow: hidden; border: 1px solid #333;">
                                <div style="position: relative;">
                                    <img src="https://images.pexels.com/photos/1266808/pexels-photo-1266808.jpeg?auto=compress&cs=tinysrgb&w=300&h=300&fit=crop" 
                                         alt="My Digital Art" style="width: 100%; height: 120px; object-fit: cover;">
                                    <div style="position: absolute; top: 8px; right: 8px; background: rgba(0,0,0,0.7); border-radius: 12px; padding: 4px 8px;">
                                        <span style="color: white; font-size: 10px; font-weight: bold;">SOLD</span>
                                    </div>
                                </div>
                                <div style="padding: 12px;">
                                    <h4 style="color: white; font-size: 14px; margin: 0 0 8px 0; font-weight: 600;">My Digital Portrait</h4>
                                    <p style="color: #ff6b6b; font-size: 16px; font-weight: bold; margin: 0 0 8px 0;">₱15,000</p>
                                    <div style="display: flex; gap: 6px;">
                                        <button style="flex: 1; padding: 8px; border: none; border-radius: 6px; background: #333; color: white; font-size: 11px; cursor: pointer;">Edit</button>
                                        <button style="padding: 8px; border: 1px solid #333; border-radius: 6px; background: transparent; color: white; font-size: 11px; cursor: pointer;">📊</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Wallet & Payments -->
                    <div class="px-4 mb-6">
                        <div class="bg-gray-900 rounded-xl p-4">
                            <h3 class="font-bold mb-4">Payment Methods</h3>
                            <div class="space-y-3">
                                <div class="flex items-center justify-between p-3 bg-gray-800 rounded-lg">
                                    <div class="flex items-center space-x-3">
                                        <i class="fab fa-paypal text-blue-500 text-xl"></i>
                                        <span>PayPal</span>
                                    </div>
                                    <span class="bg-blue-500 text-white px-2 py-1 rounded-full text-xs">Connected</span>
                                </div>
                                <div class="flex items-center justify-between p-3 bg-gray-800 rounded-lg">
                                    <div class="flex items-center space-x-3">
                                        <i class="fas fa-mobile-alt text-blue-500 text-xl"></i>
                                        <span>GCash</span>
                                    </div>
                                    <button class="bg-gray-600 text-white px-3 py-1 rounded-full text-xs">Setup</button>
                                </div>
                                <div class="flex items-center justify-between p-3 bg-gray-800 rounded-lg">
                                    <div class="flex items-center space-x-3">
                                        <i class="fab fa-bitcoin text-green-500 text-xl"></i>
                                        <span>USDT</span>
                                    </div>
                                    <button class="bg-gray-600 text-white px-3 py-1 rounded-full text-xs">Setup</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Logistics -->
                    <div class="px-4 mb-6">
                        <div class="bg-gray-900 rounded-xl p-4">
                            <h3 class="font-bold mb-4">Shipping Partners</h3>
                            <div class="space-y-3">
                                <div class="flex items-center justify-between p-3 bg-gray-800 rounded-lg">
                                    <div>
                                        <div class="font-semibold">LBC Express</div>
                                        <div class="text-xs text-gray-400">₱85 - ₱150</div>
                                    </div>
                                    <span class="bg-green-500 text-white px-2 py-1 rounded-full text-xs">Active</span>
                                </div>
                                <div class="flex items-center justify-between p-3 bg-gray-800 rounded-lg">
                                    <div>
                                        <div class="font-semibold">J&T Express</div>
                                        <div class="text-xs text-gray-400">₱65 - ₱120</div>
                                    </div>
                                    <button class="bg-gray-600 text-white px-3 py-1 rounded-full text-xs">Setup</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Add Product Modal -->
            <div id="addProductModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center;">
                <div style="background: #1a1a1a; border-radius: 12px; padding: 24px; width: 90%; max-width: 600px; border: 1px solid #333;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="color: white; margin: 0;">Add New Product</h3>
                        <button onclick="closeAddProductModal()" style="background: none; border: none; color: #888; font-size: 24px; cursor: pointer;">&times;</button>
                    </div>
                    
                    <form id="addProductForm" style="display: flex; flex-direction: column; gap: 16px;">
                        <div>
                            <label style="color: #888; font-size: 12px; display: block; margin-bottom: 4px;">Product Title *</label>
                            <input type="text" id="productTitle" required style="width: 100%; padding: 12px; border: 1px solid #333; border-radius: 6px; background: #2a2a2a; color: white; font-size: 14px;">
                        </div>
                        
                        <div>
                            <label style="color: #888; font-size: 12px; display: block; margin-bottom: 4px;">Price (₱) *</label>
                            <input type="number" id="productPrice" required min="0" step="0.01" style="width: 100%; padding: 12px; border: 1px solid #333; border-radius: 6px; background: #2a2a2a; color: white; font-size: 14px;">
                        </div>
                        
                        <div>
                            <label style="color: #888; font-size: 12px; display: block; margin-bottom: 4px;">Category *</label>
                            <select id="productCategory" required style="width: 100%; padding: 12px; border: 1px solid #333; border-radius: 6px; background: #2a2a2a; color: white; font-size: 14px;">
                                <option value="">Select Category</option>
                                <option value="art-materials">Art Materials</option>
                                <option value="busking">Busking</option>
                                <option value="digital-art">Digital Art</option>
                                <option value="musical-instruments">Musical Instruments</option>
                                <option value="painting">Painting</option>
                                <option value="sculptures">Sculptures</option>
                                <option value="services">Services</option>
                            </select>
                        </div>
                        
                        <div>
                            <label style="color: #888; font-size: 12px; display: block; margin-bottom: 4px;">Product Image</label>
                            <input type="file" id="productImage" accept="image/*" style="width: 100%; padding: 12px; border: 1px solid #333; border-radius: 6px; background: #2a2a2a; color: white; font-size: 14px;">
                        </div>
                        
                        <div>
                            <label style="color: #888; font-size: 12px; display: block; margin-bottom: 4px;">Description</label>
                            <textarea id="productDescription" rows="3" style="width: 100%; padding: 12px; border: 1px solid #333; border-radius: 6px; background: #2a2a2a; color: white; font-size: 14px; resize: vertical;"></textarea>
                        </div>
                        
                        <div id="productConditionContainer" style="display: none;">
                            <label style="color: #888; font-size: 12px; display: block; margin-bottom: 4px;">Condition *</label>
                            <select id="productCondition" style="width: 100%; padding: 12px; border: 1px solid #333; border-radius: 6px; background: #2a2a2a; color: white; font-size: 14px;">
                                <option>Select Condition</option>
                                <option value="brand-new">Brand New</option>
                                <option value="secondhand">Secondhand</option>
                            </select>
                        </div>
                        
                        <div style="display: flex; gap: 12px; margin-top: 8px;">
                            <button type="button" onclick="closeAddProductModal()" style="flex: 1; padding: 12px; border: 1px solid #333; border-radius: 6px; background: transparent; color: white; cursor: pointer;">Cancel</button>
                            <button type="button" onclick="addProduct()" style="flex: 1; padding: 12px; border: none; border-radius: 6px; background: linear-gradient(45deg, #ff6b6b, #4ecdc4); color: white; font-weight: bold; cursor: pointer;">Add Product</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Create Tab Content -->
            <div id="create-content" class="tab-content hidden">
                <div class="max-w-md mx-auto px-4">
                    <div class="bg-gray-900 rounded-2xl p-6 text-center">
                        <div class="w-20 h-20 bg-gradient-to-br from-purple-600 to-pink-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-plus text-3xl"></i>
                        </div>
                        <h2 class="text-xl font-bold mb-2">Create Content</h2>
                        <p class="text-gray-400 mb-6">Share your art with the world</p>
                        
                        <div class="space-y-4">
                            <button class="w-full bg-gradient-to-r from-purple-600 to-pink-600 py-3 rounded-xl font-semibold" onclick="startRecording()">
                                <i class="fas fa-video mr-2"></i>Camera
                            </button>
                            <button class="w-full bg-gray-800 py-3 rounded-xl font-semibold" onclick="uploadVideo()">
                                <i class="fas fa-image mr-2"></i>Gallery
                            </button>
                            <button class="w-full bg-gray-800 py-3 rounded-xl font-semibold" onclick="goLive()">
                                <i class="fas fa-broadcast-tower mr-2"></i>Go Live
                            </button>
                        </div>

                        <!-- Product Linking Section -->
                        <div class="mt-6 p-4 bg-gray-800 rounded-xl">
                            <h3 class="font-semibold mb-3">Tag Products</h3>
                            <div class="space-y-2">
                                <div class="flex items-center justify-between p-2 bg-gray-700 rounded-lg">
                                    <div class="flex items-center space-x-2">
                                        <img src="https://images.pexels.com/photos/1266808/pexels-photo-1266808.jpeg?auto=compress&cs=tinysrgb&w=40&h=40&fit=crop" 
                                             alt="Product" class="w-8 h-8 rounded">
                                        <div>
                                            <div class="text-sm font-medium">Digital Portrait NFT</div>
                                            <div class="text-xs text-gray-400">₱12,500.00</div>
                                        </div>
                                    </div>
                                    <button class="bg-purple-600 px-3 py-1 rounded-full text-xs">Tag</button>
                                </div>
                                <div class="flex items-center justify-between p-2 bg-gray-700 rounded-lg">
                                    <div class="flex items-center space-x-2">
                                        <img src="https://images.pexels.com/photos/1183992/pexels-photo-1183992.jpeg?auto=compress&cs=tinysrgb&w=40&h=40&fit=crop" 
                                             alt="Product" class="w-8 h-8 rounded">
                                        <div>
                                            <div class="text-sm font-medium">Oil Painting - Sunset</div>
                                            <div class="text-xs text-gray-400">₱8,500.00</div>
                                        </div>
                                    </div>
                                    <button class="bg-gray-600 px-3 py-1 rounded-full text-xs">Tag</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notifications Tab Content -->
            <div id="notifications-content" class="tab-content hidden">
                <div class="max-w-md mx-auto px-4">
                    <h2 class="text-xl font-bold mb-6">Notifications</h2>
                    
                    <div class="space-y-4">
                        <div class="bg-gray-900 rounded-xl p-4">
                            <div class="flex items-start space-x-3">
                                <div class="w-10 h-10 bg-gradient-to-br from-purple-600 to-pink-600 rounded-full flex items-center justify-center">
                                    <i class="fas fa-paint-brush text-sm"></i>
                                </div>
                                <div class="flex-1">
                                    <p class="text-sm"><span class="font-semibold">@artlover23</span> liked your painting</p>
                                    <p class="text-xs text-gray-400">2 minutes ago</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gray-900 rounded-xl p-4">
                            <div class="flex items-start space-x-3">
                                <div class="w-10 h-10 bg-gradient-to-br from-green-600 to-teal-600 rounded-full flex items-center justify-center">
                                    <i class="fas fa-gavel text-sm"></i>
                                </div>
                                <div class="flex-1">
                                    <p class="text-sm">New bid on your <span class="font-semibold">Digital Portrait NFT</span></p>
                                    <p class="text-xs text-gray-400">5 minutes ago</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gray-900 rounded-xl p-4">
                            <div class="flex items-start space-x-3">
                                <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-full flex items-center justify-center">
                                    <i class="fas fa-user-plus text-sm"></i>
                                </div>
                                <div class="flex-1">
                                    <p class="text-sm"><span class="font-semibold">@newartist</span> started following you</p>
                                    <p class="text-xs text-gray-400">1 hour ago</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gray-900 rounded-xl p-4">
                            <div class="flex items-start space-x-3">
                                <div class="w-10 h-10 bg-gradient-to-br from-yellow-600 to-orange-600 rounded-full flex items-center justify-center">
                                    <i class="fas fa-dollar-sign text-sm"></i>
                                </div>
                                <div class="flex-1">
                                    <p class="text-sm">Affiliate commission earned: <span class="font-semibold text-green-400">₱125.00</span></p>
                                    <p class="text-xs text-gray-400">3 hours ago</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Tab Content -->
            <div id="profile-content" class="tab-content hidden">
                <div class="max-w-md mx-auto px-4">
                    <!-- Profile Header -->
                    <div class="text-center mb-6">
                        <img src="https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=100&h=100&fit=crop" 
                             alt="Profile" class="w-20 h-20 rounded-full mx-auto mb-4">
                        <h2 class="text-xl font-bold">@artista_maya</h2>
                        <p class="text-gray-400">Digital Artist & Creator</p>
                        
                        <div class="flex justify-center space-x-8 mt-4">
                            <div class="text-center">
                                <div class="font-bold">47</div>
                                <div class="text-xs text-gray-400">Posts</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold">2.1K</div>
                                <div class="text-xs text-gray-400">Followers</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold">892</div>
                                <div class="text-xs text-gray-400">Following</div>
                            </div>
                        </div>
                    </div>

                    <!-- Profile Tabs -->
                    <div class="flex justify-center mb-6">
                        <div class="flex bg-gray-800 rounded-full p-1">
                            <button id="videos-tab" class="tab-active px-4 py-2 rounded-full text-sm font-medium">
                                <i class="fas fa-video mr-1"></i>Videos
                            </button>
                            <button id="liked-tab" class="tab-inactive px-4 py-2 rounded-full text-sm font-medium">
                                <i class="fas fa-heart mr-1"></i>Liked
                            </button>
                            <button id="bookmarks-tab" class="tab-inactive px-4 py-2 rounded-full text-sm font-medium">
                                <i class="fas fa-bookmark mr-1"></i>Saved
                            </button>
                        </div>
                    </div>

                    <!-- Videos Grid -->
                    <div id="videos-grid" class="grid grid-cols-3 gap-1 mb-6">
                        <div class="aspect-[9/16] bg-gradient-to-br from-purple-600 to-pink-600 rounded-lg relative">
                            <i class="fas fa-play absolute inset-0 flex items-center justify-center text-2xl text-white/70"></i>
                            <div class="absolute bottom-1 left-1 text-xs">2.1K</div>
                        </div>
                        <div class="aspect-[9/16] bg-gradient-to-br from-blue-600 to-teal-600 rounded-lg relative">
                            <i class="fas fa-play absolute inset-0 flex items-center justify-center text-2xl text-white/70"></i>
                            <div class="absolute bottom-1 left-1 text-xs">5.7K</div>
                        </div>
                        <div class="aspect-[9/16] bg-gradient-to-br from-green-600 to-yellow-600 rounded-lg relative">
                            <i class="fas fa-play absolute inset-0 flex items-center justify-center text-2xl text-white/70"></i>
                            <div class="absolute bottom-1 left-1 text-xs">892</div>
                        </div>
                        <div class="aspect-[9/16] bg-gradient-to-br from-red-600 to-pink-600 rounded-lg relative">
                            <i class="fas fa-play absolute inset-0 flex items-center justify-center text-2xl text-white/70"></i>
                            <div class="absolute bottom-1 left-1 text-xs">1.3K</div>
                        </div>
                        <div class="aspect-[9/16] bg-gradient-to-br from-indigo-600 to-purple-600 rounded-lg relative">
                            <i class="fas fa-play absolute inset-0 flex items-center justify-center text-2xl text-white/70"></i>
                            <div class="absolute bottom-1 left-1 text-xs">3.2K</div>
                        </div>
                        <div class="aspect-[9/16] bg-gradient-to-br from-pink-600 to-red-600 rounded-lg relative">
                            <i class="fas fa-play absolute inset-0 flex items-center justify-center text-2xl text-white/70"></i>
                            <div class="absolute bottom-1 left-1 text-xs">756</div>
                        </div>
                    </div>

                    <!-- Boost Section -->
                    <div class="bg-gray-900 rounded-xl p-4 mb-4">
                        <h3 class="font-bold mb-2">Boost Your Content</h3>
                        <p class="text-gray-400 text-sm mb-4">Increase your reach and get more views</p>
                        <div class="flex items-center justify-between">
                            <span class="text-sm">Starting at <span class="font-bold text-green-400">₱49</span></span>
                            <button class="boost-btn px-4 py-2 rounded-lg text-sm font-medium">
                                <i class="fas fa-rocket mr-1"></i>Boost Now
                            </button>
                        </div>
                    </div>

                    <!-- Chat Support -->
                    <div class="bg-gray-900 rounded-xl p-4">
                        <button class="w-full flex items-center justify-center space-x-2 py-3 bg-gray-800 rounded-lg">
                            <i class="fas fa-headset"></i>
                            <span>Chat Support</span>
                        </button>
                    </div>
                </div>
            </div>
        </main>

            <!-- Bottom Navigation -->
            <nav class="fixed bottom-0 left-0 right-0 bg-black/90 backdrop-blur-md border-t border-gray-800 justify-center">
                <div class="grid grid-cols-5 items-center py-1">
                    <button class="nav-btn flex flex-col items-center py-2 text-white w-full" data-tab="home">
                        <i class="fas fa-home text-xl mb-1"></i>
                        <span class="text-xs">Home</span>
                    </button>
                    <button class="nav-btn flex flex-col items-center py-2 text-gray-400 w-full" data-tab="shop">
                        <i class="fas fa-store text-xl mb-1"></i>
                        <span class="text-xs">Shop</span>
                    </button>
                    <button class="nav-btn flex flex-col items-center py-2 text-gray-400 w-full" data-tab="create">
                        <div class="w-8 h-8 bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg flex items-center justify-center mb-1">
                            <i class="fas fa-plus text-sm"></i>
                        </div>
                        <span class="text-xs">Create</span>
                    </button>
                    <button class="nav-btn flex flex-col items-center py-2 text-gray-400 w-full" data-tab="notifications">
                        <i class="fas fa-bell text-xl mb-1"></i>
                        <span class="text-xs">Notifications</span>
                    </button>
                    <button class="nav-btn flex flex-col items-center py-2 text-gray-400 w-full" data-tab="profile">
                        <i class="fas fa-user text-xl mb-1"></i>
                        <span class="text-xs">Profile</span>
                    </button>
                </div>
            </nav>
        </div>

        <!-- Camera Recording Modal -->
        <div id="cameraModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden">
            <div class="camera-modal">
                <div class="camera-header">
                    <button class="close-camera" onclick="closeCameraModal()">&times;</button>
                    <h3>Record Video</h3>
                    <button class="camera-flip" onclick="flipCamera()">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
                <div class="camera-container">
                    <video id="cameraPreview" autoplay muted playsinline></video>
                    <canvas id="recordingCanvas" style="display: none;"></canvas>
                </div>
                <div class="camera-controls">
                    <div class="recording-timer" id="recordingTimer" style="display: none;">00:00</div>
                    <div class="camera-buttons">
                        <button class="record-btn" id="recordBtn" onclick="toggleRecording()">
                            <div class="record-circle"></div>
                        </button>
                    </div>
                    <div class="camera-actions">
                        <button class="camera-action" onclick="addEffect()">
                            <i class="fas fa-magic"></i>
                        </button>
                        <button class="camera-action" onclick="addMusic()">
                            <i class="fas fa-music"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Gallery Upload Modal -->
        <div id="galleryModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden">
            <div class="absolute bottom-0 left-0 right-0 bg-gray-900 rounded-t-2xl max-h-[80vh] overflow-hidden modal-content">
                <div class="flex items-center justify-between p-4 border-b border-gray-700">
                    <h3>Upload from Gallery</h3>
                    <span class="close cursor-pointer text-2xl" onclick="closeGalleryModal()">&times;</span>
                </div>
                <div class="upload-area" onclick="document.getElementById('videoUpload').click()">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <p>Tap to select video from gallery</p>
                    <small>MP4, MOV, AVI up to 100MB</small>
                </div>
                <input type="file" id="videoUpload" accept="video/*" style="display: none;" onchange="handleVideoUpload(event)">
                <div id="uploadPreview" style="display: none;">
                    <video id="uploadedVideo" controls style="width: 100%; max-height: 300px;"></video>
                    <div class="upload-actions">
                        <button class="bg-gray-600 px-4 py-2 rounded-lg" onclick="closeGalleryModal()">Cancel</button>
                        <button class="bg-purple-600 px-4 py-2 rounded-lg" onclick="processUploadedVideo()">Next</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Modal -->
        <div id="chat-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden">
            <div class="absolute bottom-0 left-0 right-0 bg-gray-900 rounded-t-2xl max-h-[80vh] overflow-hidden modal-content">
                <div class="flex items-center justify-between p-4 border-b border-gray-700">
                    <div class="flex items-center space-x-3">
                        <img src="https://images.pexels.com/photos/1043471/pexels-photo-1043471.jpeg?auto=compress&cs=tinysrgb&w=40&h=40&fit=crop" 
                             alt="Seller" class="w-8 h-8 rounded-full">
                        <div>
                            <div class="font-semibold text-sm">@guitar_master</div>
                            <div class="text-xs text-gray-400">Online</div>
                        </div>
                    </div>
                    <button id="close-chat" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="p-4 h-64 overflow-y-auto space-y-3">
                    <div class="flex justify-start">
                        <div class="bg-gray-800 rounded-2xl rounded-bl-md px-4 py-2 max-w-xs">
                            <p class="text-sm">Hi! Interested in the guitar lesson?</p>
                        </div>
                    </div>
                    <div class="flex justify-end">
                        <div class="bg-purple-600 rounded-2xl rounded-br-md px-4 py-2 max-w-xs">
                            <p class="text-sm">Yes! What's included in the session?</p>
                        </div>
                    </div>
                    <div class="flex justify-start">
                        <div class="bg-gray-800 rounded-2xl rounded-bl-md px-4 py-2 max-w-xs">
                            <p class="text-sm">I teach basic chords, strumming patterns, and can help with specific songs. ₱500 per hour!</p>
                        </div>
                    </div>
                </div>
                
                <div class="p-4 border-t border-gray-700">
                    <div class="flex space-x-2">
                        <input type="text" placeholder="Type a message..." 
                               class="flex-1 bg-gray-800 border border-gray-700 rounded-full px-4 py-2 text-sm focus:outline-none focus:border-purple-500">
                        <button class="bg-purple-600 p-2 rounded-full">
                            <i class="fas fa-paper-plane text-sm"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tip Modal -->
        <div id="tipModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
            <div class="bg-gray-800 rounded-lg p-6 w-80 mx-4">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-white text-lg font-medium">Send Tip</h3>
                    <button onclick="closeTipModal()" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="space-y-4">
                    <div class="grid grid-cols-3 gap-2">
                        <button class="tip-amount bg-gray-700 text-white py-2 rounded-lg hover:bg-pink-500 transition-colors" onclick="selectTipAmount(50)">₱50</button>
                        <button class="tip-amount bg-gray-700 text-white py-2 rounded-lg hover:bg-pink-500 transition-colors" onclick="selectTipAmount(100)">₱100</button>
                        <button class="tip-amount bg-gray-700 text-white py-2 rounded-lg hover:bg-pink-500 transition-colors" onclick="selectTipAmount(200)">₱200</button>
                    </div>
                    <input type="number" id="customTipAmount" placeholder="Custom amount" class="w-full bg-gray-700 text-white px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500">
                    <button class="w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white py-2 rounded-lg font-medium hover:from-pink-600 hover:to-purple-700 transition-all" onclick="sendTip()">
                        Send Tip
                    </button>
                </div>
            </div>
        </div>

        <!-- Bid Modal -->
        <div id="bidModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-gray-800 rounded-lg p-6 w-80 mx-4">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-white text-lg font-medium">Place Bid</h3>
                    <button onclick="closeBidModal()" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="space-y-4">
                    <div class="text-center">
                        <p class="text-gray-400 text-sm">Current Bid</p>
                        <p class="text-white text-2xl font-bold" id="currentBidAmount">₱8,500</p>
                    </div>
                    <input type="number" id="bidAmount" placeholder="Your bid amount" class="w-full bg-gray-700 text-white px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500" min="8501">
                    <button class="w-full bg-gradient-to-r from-orange-500 to-red-600 text-white py-2 rounded-lg font-medium hover:from-orange-600 hover:to-red-700 transition-all" onclick="placeBid()">
                        Place Bid
                    </button>
                </div>
            </div>
        </div>

        <!-- Share Modal -->
        <div id="shareModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-gray-800 rounded-lg p-6 w-80 mx-4">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-white text-lg font-medium">Share Video</h3>
                    <button onclick="closeShareModal()" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="grid grid-cols-3 gap-4">
                    <button class="flex flex-col items-center space-y-2 p-3 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors" onclick="shareToSocial('facebook')">
                        <i class="fab fa-facebook text-blue-500 text-2xl"></i>
                        <span class="text-white text-sm">Facebook</span>
                    </button>
                    <button class="flex flex-col items-center space-y-2 p-3 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors" onclick="shareToSocial('twitter')">
                        <i class="fab fa-twitter text-blue-400 text-2xl"></i>
                        <span class="text-white text-sm">Twitter</span>
                    </button>
                    <button class="flex flex-col items-center space-y-2 p-3 bg-gray-700 rounded-lg hover:bg-gray-600 transition-colors" onclick="shareToSocial('instagram')">
                        <i class="fab fa-instagram text-pink-500 text-2xl"></i>
                        <span class="text-white text-sm">Instagram</span>
                    </button>
                </div>
                <div class="mt-4">
                    <input type="text" id="shareLink" value="https://picasso.app/video/123" class="w-full bg-gray-700 text-white px-3 py-2 rounded-lg text-sm" readonly>
                    <button class="w-full mt-2 bg-green-500 text-white py-2 rounded-lg text-sm hover:bg-green-600 transition-colors" onclick="copyLink()">
                        Copy Link
                    </button>
                </div>
            </div>
        </div>

        <!-- Linked Products Modal -->
        <div id="linkedProductsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
            <div class="bg-gray-800 rounded-lg p-6 w-96 max-h-96 overflow-y-auto mx-4">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-white text-lg font-medium">Linked Products</h3>
                    <button onclick="closeLinkedProductsModal()" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="space-y-3">
                    <div class="flex items-center space-x-3 bg-gray-700 p-3 rounded-lg">
                        <img src="https://images.pexels.com/photos/1266808/pexels-photo-1266808.jpeg?auto=compress&cs=tinysrgb&w=60&h=60&fit=crop" alt="Product" class="w-12 h-12 rounded-lg object-cover">
                        <div class="flex-1">
                            <h4 class="text-white font-medium text-sm">Digital Art Print</h4>
                            <p class="text-gray-400 text-sm">₱1,250.00</p>
                        </div>
                        <button class="bg-pink-500 text-white px-3 py-1 rounded-lg text-sm hover:bg-pink-600 transition-colors">
                            Buy
                        </button>
                    </div>
                    <div class="flex items-center space-x-3 bg-gray-700 p-3 rounded-lg">
                        <img src="https://images.pexels.com/photos/1266808/pexels-photo-1266808.jpeg?auto=compress&cs=tinysrgb&w=60&h=60&fit=crop" alt="Product" class="w-12 h-12 rounded-lg object-cover">
                        <div class="flex-1">
                            <h4 class="text-white font-medium text-sm">Art Supplies Set</h4>
                            <p class="text-gray-400 text-sm">₱850.00</p>
                        </div>
                        <button class="bg-pink-500 text-white px-3 py-1 rounded-lg text-sm hover:bg-pink-600 transition-colors">
                            Buy
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Luthier Service Modal -->
        <div id="luthierModal" class="fixed inset-0 bg-black/80 z-[200] flex items-center justify-center hidden">
            <div class="bg-gray-900 p-6 rounded-xl w-full max-w-md mx-4">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold">Request Guitar Luthier Service</h2>
                    <button onclick="closeLuthierForm()" class="p-1 rounded-full hover:bg-gray-700">
                        <i class="fas fa-times text-lg"></i>
                    </button>
                </div>
                <form id="luthierServiceForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">Service Type</label>
                        <select id="luthierServiceType" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2">
                            <option value="repair">Repair</option>
                            <option value="build">Build</option>
                            <option value="custom">Custom</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Price Range (₱)</label>
                        <div class="flex space-x-2">
                            <input type="number" id="luthierPriceMin" placeholder="Min" class="w-1/2 bg-gray-800 border border-gray-700 rounded-lg px-3 py-2">
                            <input type="number" id="luthierPriceMax" placeholder="Max" class="w-1/2 bg-gray-800 border border-gray-700 rounded-lg px-3 py-2">
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Estimated Duration (days)</label>
                        <input type="number" id="luthierDurationDays" placeholder="e.g. 10" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2" min="1">
                        <span id="durationFormatted" class="block text-xs text-gray-400 mt-1">  </span>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-1">Location</label>
                        <input type="text" id="luthierLocation" placeholder="City/Province" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2">
                    </div>
                    <button type="button" onclick="submitLuthierService()" class="w-full bg-gradient-to-r from-yellow-600 to-gray-800 text-white py-2 rounded-lg font-medium hover:from-yellow-700 hover:to-gray-900 transition-all">Submit Request</button>
                </form>
            </div>
        </div>

        <!-- Guitar Luthier Services List Modal -->
        <div id="luthierListModal" class="fixed inset-0 bg-black/80 z-[200] flex items-center justify-center hidden">
            <div class="bg-gray-900 p-8 rounded-xl w-full max-w-2xl mx-4">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold">Guitar Luthier Services</h2>
                    <button onclick="closeLuthierListModal()" class="p-1 rounded-full hover:bg-gray-700">
                        <i class="fas fa-times text-lg"></i>
                    </button>
                </div>
                <div class="space-y-6">
                    <div class="border-b border-gray-700 pb-4">
                        <h3 class="font-semibold text-lg mb-1">Guitar Luthier Services</h3>
                        <p class="text-gray-400 text-sm mb-1">Building, repair, or customization of guitars and other string instruments. We offer expert craftsmanship and quality service for all your stringed instrument needs.</p>
                        <span class="text-purple-400 font-bold">₱2,000 - ₱20,000</span>
                    </div>
                    <div class="border-b border-gray-700 pb-4">
                        <h3 class="font-semibold text-lg mb-1">Violin Luthier Services</h3>
                        <p class="text-gray-400 text-sm mb-1">Expert repair and customization for violins and other string instruments. Restore your instrument's sound and beauty with our professional luthier services.</p>
                        <span class="text-purple-400 font-bold">₱3,000 - ₱18,000</span>
                    </div>
                    <div>
                        <h3 class="font-semibold text-lg mb-1">Cello Luthier Services</h3>
                        <p class="text-gray-400 text-sm mb-1">Professional building, repair, and customization for cellos and other string instruments. Trust us to keep your cello in top playing condition.</p>
                        <span class="text-purple-400 font-bold">₱4,000 - ₱22,000</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Dropdowns moved to body level to prevent clipping -->
    <div id="servicesDropdown" class="fixed z-[99999] services-dropdown rounded-lg shadow-lg hidden bg-gray-800 border border-gray-700 w-56">
        <button class="service-subcategory w-full text-left px-3 py-2 text-white hover:bg-gray-700 rounded-none first:rounded-t-lg last:rounded-b-lg transition-colors" data-subcategory="art-class">Art Class</button>
        <button class="service-subcategory w-full text-left px-3 py-2 text-white hover:bg-gray-700 rounded-none first:rounded-t-lg last:rounded-b-lg transition-colors" data-subcategory="commissions">Commissions</button>
        <button class="service-subcategory w-full text-left px-3 py-2 text-white hover:bg-gray-700 rounded-none first:rounded-t-lg last:rounded-b-lg transition-colors" data-subcategory="drum-lesson">Drum Lesson</button>
        <button class="service-subcategory w-full text-left px-3 py-2 text-white hover:bg-gray-700 rounded-none first:rounded-t-lg last:rounded-b-lg transition-colors" data-subcategory="guitar-lesson">Guitar Lesson</button>
        <button class="service-subcategory w-full text-left px-3 py-2 text-white hover:bg-gray-700 rounded-none first:rounded-t-lg last:rounded-b-lg transition-colors" data-subcategory="guitar-luthier">Guitar Luthier Services</button>
        <button class="service-subcategory w-full text-left px-3 py-2 text-white hover:bg-gray-700 rounded-none first:rounded-t-lg last:rounded-b-lg transition-colors" data-subcategory="graphic-design">Graphic Design</button>
        <button class="service-subcategory w-full text-left px-3 py-2 text-white hover:bg-gray-700 rounded-none first:rounded-t-lg last:rounded-b-lg transition-colors" data-subcategory="makeup">Make Up</button>
        <button class="service-subcategory w-full text-left px-3 py-2 text-white hover:bg-gray-700 rounded-none first:rounded-t-lg last:rounded-b-lg transition-colors" data-subcategory="piano-lesson">Piano Lesson</button>
        <button class="service-subcategory w-full text-left px-3 py-2 text-white hover:bg-gray-700 rounded-none first:rounded-t-lg last:rounded-b-lg transition-colors" data-subcategory="saxophone-lesson">Saxophone Lesson</button>
        <button class="service-subcategory w-full text-left px-3 py-2 text-white hover:bg-gray-700 rounded-none first:rounded-t-lg last:rounded-b-lg transition-colors" data-subcategory="tattoo">Tattoo</button>
        <button class="service-subcategory w-full text-left px-3 py-2 text-white hover:bg-gray-700 rounded-none first:rounded-t-lg last:rounded-b-lg transition-colors" data-subcategory="violin-lesson">Violin Lesson</button>
        <button class="service-subcategory w-full text-left px-3 py-2 text-white hover:bg-gray-700 rounded-none first:rounded-t-lg last:rounded-b-lg transition-colors" data-subcategory="voice-lesson">Voice Lesson</button>
    </div>

    <div id="instrumentsDropdown" class="fixed z-[99999] services-dropdown rounded-lg shadow-lg hidden bg-gray-800 border border-gray-700 w-56">
        <button class="instruments-subcategory w-full px-3 py-2 text-white hover:bg-gray-700 text-left rounded-none first:rounded-t-lg last:rounded-b-lg transition-colors" data-subcategory="brand-new">Brand New</button>
        <button class="instruments-subcategory w-full px-3 py-2 text-white hover:bg-gray-700 text-left rounded-none first:rounded-t-lg last:rounded-b-lg transition-colors" data-subcategory="second-hand">Second Hand</button>
    </div>
    
    <script>
        let currentFilter = 'friends';
        
        // Tab Navigation
        const navButtons = document.querySelectorAll('.nav-btn');
        const tabContents = document.querySelectorAll('.tab-content');
        
        navButtons.forEach(button => {
            button.addEventListener('click', () => {
                const targetTab = button.getAttribute('data-tab');
                
                // Update nav button states
                navButtons.forEach(btn => {
                    if (btn.getAttribute('data-tab') === targetTab) {
                        btn.classList.remove('text-gray-400');
                        btn.classList.add('text-white');
                    } else {
                        btn.classList.remove('text-white');
                        btn.classList.add('text-gray-400');
                    }
                });
                
                // Show/hide tab content
                tabContents.forEach(content => {
                    if (content.id === targetTab + '-content') {
                        content.classList.remove('hidden');
                        // Add home-tab-active class for home tab
                        if (targetTab === 'home') {
                            content.classList.add('home-tab-active');
                        }
                    } else {
                        content.classList.add('hidden');
                        content.classList.remove('home-tab-active');
                    }
                });
                
                // Update bid/tip button states based on current filter
                if (targetTab === 'home') {
                    updateButtonStates();
                }
            });
        });
        
        // Navigation filter buttons (only in home tab)
        const navFilterButtons = document.querySelectorAll('.nav-filter-btn');
        
        navFilterButtons.forEach(button => {
            button.addEventListener('click', () => {
                const filter = button.getAttribute('data-filter');
                currentFilter = filter;
                
                // Update active button
                navFilterButtons.forEach(btn => {
                    btn.classList.remove('active');
                });
                button.classList.add('active');
                
                // Update button states
                updateButtonStates();
                
                // Filter content based on selection
                filterContent(filter);
            });
        });
        
        function updateButtonStates() {
            const videos = document.querySelectorAll('#home-content .relative');
            
            videos.forEach(video => {
                const bidBtn = video.querySelector('.bid-btn i');
                const tipBtn = video.querySelector('.tip-btn i');
                const category = video.dataset.category;
                const hasAuction = video.querySelector('.bid-btn').dataset.auction === 'true';
                
                // Reset colors
                bidBtn.classList.remove('bid-available');
                tipBtn.classList.remove('tip-available');
                
                // Update bid button - yellow if auction available
                if (hasAuction) {
                    bidBtn.classList.add('bid-available');
                }
                
                // Update tip button - yellow if busking filter is active or video is busking category
                if (currentFilter === 'busking' || category === 'busking') {
                    tipBtn.classList.add('tip-available');
                }
            });
        }
        
        function filterContent(filter) {
            const videos = document.querySelectorAll('#home-content .relative');
            
            videos.forEach(video => {
                const category = video.dataset.category;
                
                // Show/hide videos based on filter
                switch(filter) {
                    case 'friends':
                        video.style.display = 'block';
                        break;
                    case 'artists':
                        video.style.display = category === 'painting' ? 'block' : 'none';
                        break;
                    case 'feed':
                        video.style.display = 'block';
                        break;
                    case 'busking':
                        video.style.display = category === 'busking' ? 'block' : 'none';
                        break;
                    default:
                        video.style.display = 'block';
                }
            });
        }
        
        // Initialize button states
        document.addEventListener('DOMContentLoaded', function() {
            updateButtonStates();
        });
        
        // Shop Tabs
        const marketplaceTab = document.getElementById('marketplace-tab');
        const myshopTab = document.getElementById('myshop-tab');
        const marketplaceContent = document.getElementById('marketplace-content');
        const myshopContent = document.getElementById('myshop-content');
        
        marketplaceTab.addEventListener('click', () => {
            marketplaceTab.classList.remove('tab-inactive');
            marketplaceTab.classList.add('tab-active');
            myshopTab.classList.remove('tab-active');
            myshopTab.classList.add('tab-inactive');
            
            marketplaceContent.classList.remove('hidden');
            myshopContent.classList.add('hidden');
        });
        
        myshopTab.addEventListener('click', () => {
            myshopTab.classList.remove('tab-inactive');
            myshopTab.classList.add('tab-active');
            marketplaceTab.classList.remove('tab-active');
            marketplaceTab.classList.add('tab-inactive');
            
            myshopContent.classList.remove('hidden');
            marketplaceContent.classList.add('hidden');
        });
        
        // Profile Tabs
        const videosTab = document.getElementById('videos-tab');
        const likedTab = document.getElementById('liked-tab');
        const bookmarksTab = document.getElementById('bookmarks-tab');
        
        [videosTab, likedTab, bookmarksTab].forEach(tab => {
            tab.addEventListener('click', () => {
                // Reset all tabs
                [videosTab, likedTab, bookmarksTab].forEach(t => {
                    t.classList.remove('tab-active');
                    t.classList.add('tab-inactive');
                });
                
                // Activate clicked tab
                tab.classList.remove('tab-inactive');
                tab.classList.add('tab-active');
            });
        });
        
        // Category filtering functionality
        const categoryButtons = document.querySelectorAll('.category-btn');
        categoryButtons.forEach(button => {
            button.addEventListener('click', () => {
                const category = button.getAttribute('data-category');
                
                // Don't filter if it's a dropdown button (services or instruments)
                if ((category === 'services' || category === 'instruments') && button.onclick) {
                    return;
                }
                
                // Update active button
                categoryButtons.forEach(btn => {
                    btn.classList.remove('bg-purple-600', 'text-white');
                    btn.classList.add('bg-gray-700', 'text-gray-300');
                });
                
                button.classList.remove('bg-gray-700', 'text-gray-300');
                button.classList.add('bg-purple-600', 'text-white');
                
                // Filter products
                const products = document.querySelectorAll('.product-card');
                products.forEach(product => {
                    const productCategory = product.getAttribute('data-category');
                    if (category === 'all' || productCategory === category) {
                        product.style.display = 'block';
                    } else {
                        product.style.display = 'none';
                    }
                });
            });
        });
        
        // Real-time interactive functions
        function toggleBrush(element) {
            const icon = element.querySelector('i');
            const countElement = element.parentElement.querySelector('.brush-count');
            let count = parseInt(element.dataset.count);
            
            if (icon.classList.contains('text-pink-500')) {
                // Unlike
                count--;
                icon.classList.remove('text-pink-500');
                icon.classList.add('text-gray-400');
                element.dataset.liked = 'false';
            } else {
                // Like
                count++;
                icon.classList.remove('text-gray-400');
                icon.classList.add('text-pink-500');
                element.dataset.liked = 'true';
                
                // Animation effect
                icon.style.transform = 'scale(1.3)';
                setTimeout(() => {
                    icon.style.transform = 'scale(1)';
                }, 200);
            }
            
            element.dataset.count = count;
            countElement.textContent = formatCount(count);
        }
        
        function toggleComments(button) {
            const videoCard = button.closest('.relative');
            const panel = videoCard.querySelector('.comments-section');
        
            // Hide all other comment sections first
            document.querySelectorAll('.comments-section').forEach(p => {
                if (p !== panel) {
                    p.classList.remove('translate-x-0');
                    p.classList.add('translate-x-full');
                }
            }); 
        
            // Toggle current one
            if (panel.classList.contains('translate-x-full')) {
                panel.classList.remove('translate-x-full');
                panel.classList.add('translate-x-0');
            } else {
                panel.classList.remove('translate-x-0');
                panel.classList.add('translate-x-full');
            }
        }
        
        
        
        
        function addComment(button) {
            const input = button.previousElementSibling;
            const commentText = input.value.trim();
            
            if (commentText) {
                const commentsContainer = button.closest('.comments-section').querySelector('.overflow-y-auto');
                const newComment = document.createElement('div');
                newComment.className = 'flex items-start space-x-2';
                newComment.innerHTML = `
                    <img src="https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=30&h=30&fit=crop" alt="User" class="w-6 h-6 rounded-full">
                    <div>
                        <span class="text-white text-sm font-medium">@you</span>
                        <p class="text-gray-300 text-sm">${commentText}</p>
                    </div>
                `;
                
                commentsContainer.appendChild(newComment);
                input.value = '';
                
                // Update comment count
                const commentBtn = button.closest('.relative').querySelector('.comment-btn');
                const countElement = commentBtn.parentElement.querySelector('.comment-count');
                let count = parseInt(commentBtn.dataset.count);
                count++;
                commentBtn.dataset.count = count;
                countElement.textContent = formatCount(count);
                
                // Scroll to bottom
                commentsContainer.scrollTop = commentsContainer.scrollHeight;
            }
        }
        
        function shareVideo(element) {
            document.getElementById('shareModal').classList.remove('hidden');
            
            // Update share count
            const countElement = element.parentElement.querySelector('.share-count');
            let count = parseInt(element.dataset.count);
            count++;
            element.dataset.count = count;
            countElement.textContent = formatCount(count);
        }
        
        function closeShareModal() {
            document.getElementById('shareModal').classList.add('hidden');
        }
        
        function shareToSocial(platform) {
            const link = document.getElementById('shareLink').value;
            let shareUrl = '';
            
            switch(platform) {
                case 'facebook':
                    shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(link)}`;
                    break;
                case 'twitter':
                    shareUrl = `https://twitter.com/intent/tweet?url=${encodeURIComponent(link)}&text=Check out this amazing art!`;
                    break;
                case 'instagram':
                    // Instagram doesn't support direct URL sharing, so copy to clipboard
                    copyLink();
                    showNotification('Link copied! Paste it in Instagram');
                    return;
            }
            
            if (shareUrl) {
                window.open(shareUrl, '_blank', 'width=600,height=400');
            }
            closeShareModal();
        }
        
        function copyLink() {
            const input = document.getElementById('shareLink');
            input.select();
            document.execCommand('copy');
            showNotification('Link copied to clipboard!');
        }
        
        function showTipModal(element) {
            document.getElementById('tipModal').classList.remove('hidden');
        }
        
        function closeTipModal() {
            document.getElementById('tipModal').classList.add('hidden');
        }
        
        function selectTipAmount(amount) {
            document.getElementById('customTipAmount').value = amount;
            
            // Visual feedback
            document.querySelectorAll('.tip-amount').forEach(btn => {
                btn.classList.remove('bg-pink-500');
                btn.classList.add('bg-gray-700');
            });
            event.target.classList.remove('bg-gray-700');
            event.target.classList.add('bg-pink-500');
        }
        
        function sendTip() {
            const amount = document.getElementById('customTipAmount').value;
            if (amount && amount > 0) {
                showNotification(`Tip of ₱${amount} sent successfully!`);
                closeTipModal();
            } else {
                alert('Please enter a valid tip amount');
            }
        }
        
        function showBidModal(element) {
            const isAuction = element.dataset.auction === 'true';
            if (isAuction) {
                document.getElementById('bidModal').classList.remove('hidden');
            } else {
                showTipModal(element);
            }
        }
        
        function closeBidModal() {
            document.getElementById('bidModal').classList.add('hidden');
        }
        
        function placeBid() {
            const bidAmount = document.getElementById('bidAmount').value;
            const currentBid = parseInt(document.getElementById('currentBidAmount').textContent.replace(/[₱,]/g, ''));
            
            if (bidAmount && parseInt(bidAmount) > currentBid) {
                document.getElementById('currentBidAmount').textContent = `₱${parseInt(bidAmount).toLocaleString()}`;
                showNotification(`Bid of ₱${parseInt(bidAmount).toLocaleString()} placed successfully!`);
                closeBidModal();
            } else {
                alert(`Please enter a bid higher than ₱${currentBid.toLocaleString()}`);
            }
        }
        
        function toggleFollow(button) {
            if (button.textContent.trim() === 'Follow') {
                button.textContent = 'Following';
                button.classList.remove('from-pink-500', 'to-purple-600');
                button.classList.add('bg-gray-600');
                showNotification('Now following this user!');
            } else {
                button.textContent = 'Follow';
                button.classList.remove('bg-gray-600');
                button.classList.add('from-pink-500', 'to-purple-600');
            }
        }
        
        function formatCount(count) {
            if (count >= 1000000) {
                return (count / 1000000).toFixed(1) + 'M';
            } else if (count >= 1000) {
                return (count / 1000).toFixed(1) + 'K';
            }
            return count.toString();
        }
        
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-24 left-1/2 transform -translate-x-1/2 bg-gray-800 text-white px-6 py-3 rounded-full z-50 transition-all border border-gray-600';
            notification.innerHTML = `<i class="fas fa-check mr-2 text-green-400"></i>${message}`;
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.transform = 'translate(-50%, 0)';
            }, 100);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.transform = 'translate(-50%, -100px)';
                notification.style.opacity = '0';
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 3000);
        }
        
        // Add CSS for animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideUp {
                from {
                    opacity: 0;
                    transform: translateY(20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            
            .brush-btn i {
                transition: all 0.2s ease;
            }
            
            .brush-btn:hover i {
                transform: scale(1.1);
            }
        `;
        document.head.appendChild(style);
        
        function viewLinkedProducts(element) {
            document.getElementById('linkedProductsModal').classList.remove('hidden');
        }
        
        function closeLinkedProductsModal() {
            document.getElementById('linkedProductsModal').classList.add('hidden');
        }
        
        // Services dropdown functionality
        // Track dropdown state
        let servicesDropdownOpen = false;
        let instrumentsDropdownOpen = false;
        
        function toggleDropdown(button, dropdownId, stateVariable) {
            const dropdown = document.getElementById(dropdownId);
            const buttonRect = button.getBoundingClientRect();
            const screenWidth = window.innerWidth;
        
            // Close other dropdowns
            if (dropdownId !== 'servicesDropdown' && servicesDropdownOpen) {
                document.getElementById('servicesDropdown').classList.add('hidden');
                const servicesBtn = document.querySelector('[data-category="services"]');
                servicesBtn.classList.remove('bg-purple-600', 'text-white');
                servicesBtn.classList.add('bg-gray-700', 'text-gray-300');
                servicesDropdownOpen = false;
            }
            if (dropdownId !== 'instrumentsDropdown' && instrumentsDropdownOpen) {
                document.getElementById('instrumentsDropdown').classList.add('hidden');
                const instrumentsBtn = document.querySelector('[data-category="instruments"]');
                instrumentsBtn.classList.remove('bg-purple-600', 'text-white');
                instrumentsBtn.classList.add('bg-gray-700', 'text-gray-300');
                instrumentsDropdownOpen = false;
            }
        
            // Toggle current dropdown
            dropdown.classList.toggle('hidden');
            const isOpen = !dropdown.classList.contains('hidden');
        
            if (isOpen) {
                button.classList.remove('bg-gray-700', 'text-gray-300');
                button.classList.add('bg-purple-600', 'text-white');
        
                // Initial position
                dropdown.style.top = (buttonRect.bottom + window.scrollY + 8) + 'px';
                dropdown.style.left = buttonRect.left + 'px';
        
                // Check for overflow and adjust
                const dropdownRect = dropdown.getBoundingClientRect();
                if (dropdownRect.right > screenWidth) {
                    dropdown.style.left = (screenWidth - dropdownRect.width - 8) + 'px';
                }
                if (dropdownRect.left < 0) {
                    dropdown.style.left = '8px';
                }
            } else {
                button.classList.remove('bg-purple-600', 'text-white');
                button.classList.add('bg-gray-700', 'text-gray-300');
            }
        
            // Update state
            if (stateVariable === 'services') {
                servicesDropdownOpen = isOpen;
            } else if (stateVariable === 'instruments') {
                instrumentsDropdownOpen = isOpen;
            }
        }
        
        function toggleServicesDropdown() {
            const button = document.querySelector('[data-category="services"]');
            toggleDropdown(button, 'servicesDropdown', 'services');
        }
        
        function toggleInstrumentsDropdown() {
            const button = document.querySelector('[data-category="instruments"]');
            toggleDropdown(button, 'instrumentsDropdown', 'instruments');
        }
        
        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            // Services dropdown
            const servicesDropdown = document.getElementById('servicesDropdown');
            const servicesButton = event.target.closest('[onclick="toggleServicesDropdown()"]');
            const servicesBtn = document.querySelector('[data-category="services"]');
            if (!servicesButton && !servicesDropdown.contains(event.target)) {
                servicesDropdown.classList.add('hidden');
                servicesBtn.classList.remove('bg-purple-600', 'text-white');
                servicesBtn.classList.add('bg-gray-700', 'text-gray-300');
                servicesDropdownOpen = false;
            }
            
            // Instruments dropdown
            const instrumentsDropdown = document.getElementById('instrumentsDropdown');
            const instrumentsButton = event.target.closest('[onclick="toggleInstrumentsDropdown()"]');
            const instrumentsBtn = document.querySelector('[data-category="instruments"]');
            
            if (!instrumentsButton && !instrumentsDropdown.contains(event.target)) {
                instrumentsDropdown.classList.add('hidden');
                instrumentsBtn.classList.remove('bg-purple-600', 'text-white');
                instrumentsBtn.classList.add('bg-gray-700', 'text-gray-300');
                instrumentsDropdownOpen = false;
            }
        });
        
        // When another category is selected, close dropdowns and remove highlights
        categoryButtons.forEach(button => {
            button.addEventListener('click', () => {
                const category = button.getAttribute('data-category');
                
                if (category !== 'services') {
                    const servicesBtn = document.querySelector('[data-category="services"]');
                    servicesBtn.classList.remove('bg-purple-600', 'text-white');
                    servicesBtn.classList.add('bg-gray-700', 'text-gray-300');
                    servicesDropdownOpen = false;
                    document.getElementById('servicesDropdown').classList.add('hidden');
                }
                
                if (category !== 'instruments') {
                    const instrumentsBtn = document.querySelector('[data-category="instruments"]');
                    instrumentsBtn.classList.remove('bg-purple-600', 'text-white');
                    instrumentsBtn.classList.add('bg-gray-700', 'text-gray-300');
                    instrumentsDropdownOpen = false;
                    document.getElementById('instrumentsDropdown').classList.add('hidden');
                }
            });
        });
        
        // Service subcategory filtering
        document.querySelectorAll('.service-subcategory').forEach(button => {
            button.addEventListener('click', function() {
                const subcategory = this.dataset.subcategory;
                const products = document.querySelectorAll('.product-card');
                
                products.forEach(product => {
                    if (product.dataset.subcategory === subcategory || subcategory === 'all') {
                        product.style.display = 'block';
                    } else {
                        product.style.display = 'none';
                    }
                });
                
                // Remove highlight from all main categories
                document.querySelectorAll('.category-btn').forEach(btn => {
                    btn.classList.remove('bg-purple-600', 'text-white');
                    btn.classList.add('bg-gray-700', 'text-gray-300');
                });
                // Highlight only Services
                const servicesBtn = document.querySelector('[data-category="services"]');
                servicesBtn.classList.remove('bg-gray-700', 'text-gray-300');
                servicesBtn.classList.add('bg-purple-600', 'text-white');
                // Close dropdown
                document.getElementById('servicesDropdown').classList.add('hidden');
                servicesDropdownOpen = false;
            });
        });
        
        // Instrument subcategory filtering (just like services)
        document.querySelectorAll('.instruments-subcategory').forEach(button => {
            button.addEventListener('click', function () {
                const subcategory = this.dataset.subcategory;
                const products = document.querySelectorAll('.product-card');
        
                products.forEach(product => {
                    if (product.dataset.subcategory === subcategory || subcategory === 'all') {
                        product.style.display = 'block';
                    } else {
                        product.style.display = 'none';
                    }
                });
        
                // Highlight Instruments
                document.querySelectorAll('.category-btn').forEach(btn => {
                    btn.classList.remove('bg-purple-600', 'text-white');
                    btn.classList.add('bg-gray-700', 'text-gray-300');
                });
        
                const instrumentsBtn = document.querySelector('[data-category="instruments"]');
                instrumentsBtn.classList.remove('bg-gray-700', 'text-gray-300');
                instrumentsBtn.classList.add('bg-purple-600', 'text-white');
        
                // Close dropdown
                document.getElementById('instrumentsDropdown').classList.add('hidden');
                instrumentsDropdownOpen = false;
            });
        });
        
        // (Optional) Add filtering here if needed
        document.querySelectorAll('.instruments-subcategory').forEach(button => {
            button.addEventListener('click', function () {
                const subcategory = this.dataset.subcategory;
        
                // Hide dropdown and highlight button
                const instrumentsBtn = document.querySelector('[data-category="instruments"]');
                instrumentsBtn.classList.remove('bg-gray-700', 'text-gray-300');
                instrumentsBtn.classList.add('bg-purple-600', 'text-white');
                document.getElementById('instrumentsDropdown').classList.add('hidden');
                instrumentsDropdownOpen = false;
            });
        });
        
        // Luthier Service Modal Functions
        function openLuthierForm() {
            document.getElementById('luthierModal').classList.remove('hidden');
        }
        
        function closeLuthierForm() {
            document.getElementById('luthierModal').classList.add('hidden');
            // Clear all input fields in the modal
            document.getElementById('luthierServiceType').value = 'repair';
            document.getElementById('luthierPriceMin').value = '';
            document.getElementById('luthierPriceMax').value = '';
            document.getElementById('luthierDurationDays').value = '';
            document.getElementById('durationFormatted').textContent = '';
            document.getElementById('luthierLocation').value = '';
        }
        
        function submitLuthierService() {
            const type = document.getElementById('luthierServiceType').value;
            const priceMin = document.getElementById('luthierPriceMin').value;
            const priceMax = document.getElementById('luthierPriceMax').value;
            const duration = document.getElementById('luthierDuration').value;
            const location = document.getElementById('luthierLocation').value;
        
            if (!type || !priceMin || !priceMax || !duration || !location) {
                alert('Please fill in all fields.');
                return;
            }
        
            // Here you would handle the form submission (e.g., send to backend or show confirmation)
            alert(`Request submitted!\nType: ${type}\nPrice: ₱${priceMin} - ₱${priceMax}\nDuration: ${duration}\nLocation: ${location}`);
            closeLuthierForm();
        }
        
        function openLuthierListModal() {
            document.getElementById('luthierListModal').classList.remove('hidden');
        }
        
        function closeLuthierListModal() {
            document.getElementById('luthierListModal').classList.add('hidden');
        }
        
        // Chat Modal
        const chatModal = document.getElementById('chat-modal');
        const closeChatBtn = document.getElementById('close-chat');
        
        function openChat() {
            chatModal.classList.remove('hidden');
        }
        
        closeChatBtn.addEventListener('click', () => {
            chatModal.classList.add('hidden');
        });
        
        chatModal.addEventListener('click', (e) => {
            if (e.target === chatModal) {
                chatModal.classList.add('hidden');
            }
        });
        
        // Buy Button Actions
        // Remove global add-to-cart for all buy-btns
        // Only add to cart for non-luthier buy-btns
        
        // Remove or comment out this block:
        // document.querySelectorAll('.buy-btn').forEach(btn => {
        //     btn.addEventListener('click', (e) => {
        //         e.stopPropagation();
        //         // Create a simple notification
        //         const notification = document.createElement('div');
        //         notification.className = 'fixed top-24 left-1/2 transform -translate-x-1/2 bg-green-600 text-white px-6 py-3 rounded-full z-50 transition-all';
        //         notification.innerHTML = '<i class="fas fa-check mr-2"></i>Added to cart!';
        //         document.body.appendChild(notification);
        //         setTimeout(() => {
        //             notification.remove();
        //         }, 2000);
        //     });
        // });
        
        // Instead, use event delegation for buy-btns:
        document.addEventListener('click', function(e) {
            const buyBtn = e.target.closest('.buy-btn');
            if (!buyBtn) return;
            const luthierCard = buyBtn.closest('.product-card[data-subcategory="guitar-luthier"]');
            if (luthierCard) {
                openLuthierForm();
                e.preventDefault();
                e.stopPropagation();
                return;
            }
            // For other buy-btns, show add-to-cart notification as before
            // (copy the notification code here if needed)
            const notification = document.createElement('div');
            notification.className = 'fixed top-24 left-1/2 transform -translate-x-1/2 bg-green-600 text-white px-6 py-3 rounded-full z-50 transition-all';
            notification.innerHTML = '<i class="fas fa-check mr-2"></i>Added to cart!';
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.remove();
            }, 2000);
        });
        
        // Follow Button Actions
        document.querySelectorAll('.follow-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.stopPropagation();
                
                if (btn.innerHTML.includes('Follow')) {
                    btn.innerHTML = '<i class="fas fa-check mr-1"></i>Following';
                    btn.classList.add('bg-gray-600');
                    btn.classList.remove('follow-btn');
                } else {
                    btn.innerHTML = '<i class="fas fa-plus mr-1"></i>Follow';
                    btn.classList.remove('bg-gray-600');
                    btn.classList.add('follow-btn');
                }
            });
        });
        
        // Add Product Modal Functions
        function openAddProductModal() {
            document.getElementById('addProductModal').style.display = 'flex';
        }
        
        function closeAddProductModal() {
            document.getElementById('addProductModal').style.display = 'none';
        }
        
        function addProduct() {
            const title = document.getElementById('productTitle').value;
            const price = document.getElementById('productPrice').value;
            const category = document.getElementById('productCategory').value;
            const description = document.getElementById('productDescription').value;
            const imageFile = document.getElementById('productImage').files[0];
            const condition = document.getElementById('productCondition').value;
            
            if (!title || !price || !category) {
                alert('Please fill in all required fields');
                return;
            }
            if (category === 'instruments' && !condition) {
                alert('Please select the item condition');
                return;
            }
            // Create new product card
            const productsGrid = document.querySelector('#myshop-content .products-grid');
            const marketplaceGrid = document.querySelector('#marketplace-content > div.grid');
            const newProduct = document.createElement('div');
            newProduct.className = 'product-card';
            newProduct.setAttribute('data-category', category);
            if (category === 'instruments') {
                newProduct.setAttribute('data-condition', condition);
            }
            newProduct.style.cssText = 'background: #1a1a1a; border-radius: 12px; overflow: hidden; border: 1px solid #333;';
            // Handle image preview
            let imageHTML = '<div style="width: 100%; height: 120px; background: linear-gradient(45deg, #333, #555); display: flex; align-items: center; justify-content: center; color: #888;"><span>📷</span></div>';
            if (imageFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    newProduct.querySelector('.product-image').innerHTML = `<img src="${e.target.result}" style="width: 100%; height: 120px; object-fit: cover;">`;
                };
                reader.readAsDataURL(imageFile);
            }
            // Add condition display for instruments
            let conditionHTML = '';
            if (category === 'musical-instruments') {
                conditionHTML = `<span style=\"display:inline-block;padding:2px 8px;background:#333;color:#fff;border-radius:8px;font-size:11px;margin-bottom:6px;\">${condition === 'brand-new' ? 'Brand New' : 'Secondhand'}</span>`;
            }
            newProduct.innerHTML = `
                <div style="position: relative;" class="product-image">
                    ${imageHTML}
                    <div style="position: absolute; top: 8px; right: 8px; background: rgba(0,0,0,0.7); border-radius: 12px; padding: 4px 8px;">
                        <span style="color: white; font-size: 10px; font-weight: bold;">NEW</span>
                    </div>
                </div>
                <div style="padding: 12px;">
                    ${conditionHTML}
                    <h4 style="color: white; font-size: 14px; margin: 0 0 8px 0; font-weight: 600;">${title}</h4>
                    <p style="color: #ff6b6b; font-size: 16px; font-weight: bold; margin: 0 0 8px 0;">₱${parseFloat(price).toLocaleString()}</p>
                    ${description ? `<p style=\"color: #888; font-size: 11px; margin: 0 0 8px 0;\">${description}</p>` : ''}
                    <div style="display: flex; gap: 6px;">
                        <button style="flex: 1; padding: 8px; border: none; border-radius: 6px; background: linear-gradient(45deg, #ff6b6b, #4ecdc4); color: white; font-size: 11px; font-weight: bold; cursor: pointer;">Buy Now</button>
                        <button onclick="openChat()" style="padding: 8px; border: 1px solid #333; border-radius: 6px; background: transparent; color: white; font-size: 11px; cursor: pointer;">💬</button>
                    </div>
                </div>
            `;
            productsGrid.appendChild(newProduct);
            // Also add to marketplace
            if (marketplaceGrid) {
                const newProductForMarketplace = newProduct.cloneNode(true);
                marketplaceGrid.appendChild(newProductForMarketplace);
            }
            // Update stats
            const totalProducts = document.querySelectorAll('#myshop-content .product-card').length;
            document.querySelector('#myshop-content .stat-number').textContent = totalProducts;
            // Clear form and close modal
            document.getElementById('addProductForm').reset();
            closeAddProductModal();
            alert('Product added successfully!');
        }
        
        // Camera and Video Recording Functions
        let currentUser = 'user123';
        let isRecording = false;
        let mediaRecorder;
        let recordingStream;
        let recordingStartTime;
        let recordingTimer;
        let currentCamera = 'user'; // 'user' for front, 'environment' for back
        
        function startRecording() {
            document.getElementById('cameraModal').classList.remove('hidden');
            initializeCamera();
        }
        
        async function initializeCamera() {
            try {
                const constraints = {
                    video: {
                        facingMode: currentCamera,
                        width: { ideal: 1080 },
                        height: { ideal: 1920 }
                    },
                    audio: true
                };
        
                recordingStream = await navigator.mediaDevices.getUserMedia(constraints);
                const video = document.getElementById('cameraPreview');
                video.srcObject = recordingStream;
            } catch (error) {
                console.error('Error accessing camera:', error);
                alert('Unable to access camera. Please check permissions.');
            }
        }
        
        function closeCameraModal() {
            if (recordingStream) {
                recordingStream.getTracks().forEach(track => track.stop());
            }
            if (isRecording) {
                stopRecording();
            }
            document.getElementById('cameraModal').classList.add('hidden');
        }
        
        async function flipCamera() {
            currentCamera = currentCamera === 'user' ? 'environment' : 'user';
            if (recordingStream) {
                recordingStream.getTracks().forEach(track => track.stop());
            }
            await initializeCamera();
        }
        
        function toggleRecording() {
            if (isRecording) {
                stopRecording();
            } else {
                startVideoRecording();
            }
        }
        
        function startVideoRecording() {
            if (!recordingStream) return;
        
            const recordBtn = document.getElementById('recordBtn');
            const timer = document.getElementById('recordingTimer');
            
            recordBtn.classList.add('recording');
            timer.style.display = 'block';
            
            mediaRecorder = new MediaRecorder(recordingStream);
            const chunks = [];
            
            mediaRecorder.ondataavailable = (event) => {
                if (event.data.size > 0) {
                    chunks.push(event.data);
                }
            };
            
            mediaRecorder.onstop = () => {
                const blob = new Blob(chunks, { type: 'video/webm' });
                // Process recorded video
                processRecordedVideo(blob);
            };
            
            mediaRecorder.start();
            isRecording = true;
            recordingStartTime = Date.now();
            
            recordingTimer = setInterval(updateRecordingTimer, 1000);
        }
        
        function stopRecording() {
            if (mediaRecorder && isRecording) {
                mediaRecorder.stop();
                isRecording = false;
                
                const recordBtn = document.getElementById('recordBtn');
                const timer = document.getElementById('recordingTimer');
                
                recordBtn.classList.remove('recording');
                timer.style.display = 'none';
                
                clearInterval(recordingTimer);
            }
        }
        
        function updateRecordingTimer() {
            const elapsed = Math.floor((Date.now() - recordingStartTime) / 1000);
            const minutes = Math.floor(elapsed / 60).toString().padStart(2, '0');
            const seconds = (elapsed % 60).toString().padStart(2, '0');
            document.getElementById('recordingTimer').textContent = `${minutes}:${seconds}`;
        }
        
        function processRecordedVideo(blob) {
            // Create video URL and show preview
            const videoUrl = URL.createObjectURL(blob);
            console.log('Video recorded:', videoUrl);
            alert('Video recorded successfully! Processing...');
            closeCameraModal();
        }
        
        function addEffect() {
            alert('Effects feature coming soon!');
        }
        
        function addMusic() {
            alert('Music feature coming soon!');
        }
        
        function uploadVideo() {
            document.getElementById('galleryModal').classList.remove('hidden');
        }
        
        function closeGalleryModal() {
            document.getElementById('galleryModal').classList.add('hidden');
            document.getElementById('uploadPreview').style.display = 'none';
            document.getElementById('videoUpload').value = '';
        }
        
        function handleVideoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const video = document.getElementById('uploadedVideo');
                const preview = document.getElementById('uploadPreview');
                
                video.src = URL.createObjectURL(file);
                preview.style.display = 'block';
            }
        }
        
        function processUploadedVideo() {
            const video = document.getElementById('uploadedVideo');
            console.log('Processing uploaded video:', video.src);
            alert('Video uploaded successfully! Processing...');
            closeGalleryModal();
        }
        
        function goLive() {
            alert('Live streaming feature will be implemented here');
        }
        
        // Authentication functions
        function showAuthModal() {
            document.getElementById('authModal').classList.remove('hidden');
        }
        
        function closeAuthModal() {
            document.getElementById('authModal').classList.add('hidden');
        }
        
        function showLoginForm() {
            document.getElementById('signupForm').classList.add('hidden');
            document.getElementById('loginForm').classList.remove('hidden');
        }
        
        function showSignupForm() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('signupForm').classList.remove('hidden');
        }
        
        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                alert('Please enter both email and password');
                return;
            }
            
            // Simulate login
            alert('Login successful!');
            closeAuthModal();
            
            // Update UI to show logged in state
            document.querySelector('.header-user-section').innerHTML = `
                <div class="flex items-center space-x-2">
                    <img src="https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=50&h=50&fit=crop" 
                         alt="Profile" class="w-8 h-8 rounded-full">
                    <span class="text-sm font-medium">@username</span>
                </div>
            `;
        }
        
        function signup() {
            const username = document.getElementById('signupUsername').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('signupConfirmPassword').value;
            
            if (!username || !email || !password || !confirmPassword) {
                alert('Please fill all fields');
                return;
            }
            
            if (password !== confirmPassword) {
                alert('Passwords do not match');
                return;
            }
            
            // Simulate signup
            alert('Account created successfully! You can now log in.');
            showLoginForm();
        }
        
        function openMessagesPanel() {
            document.getElementById('messagesPanel').classList.remove('hidden');
        }
        
        function closeMessagesPanel() {
            document.getElementById('messagesPanel').classList.add('hidden');
        }
        
        function openChat(userId) {
            // Simulate opening a specific chat
            document.getElementById('activeChatUser').innerText = userId === 'user1' ? '@artista_maya' : '@creative_soul';
            
            // You would normally load chat messages here
        }
        
        // Search functionality
        function toggleSearch() {
            document.getElementById('searchOverlay').classList.toggle('hidden');
        }
        
        function closeSearch() {
            document.getElementById('searchOverlay').classList.add('hidden');
        }
        
        // Favorites collection
        function toggleFavorites() {
            document.getElementById('favoritesPanel').classList.toggle('hidden');
        }
        
        function closeFavorites() {
            document.getElementById('favoritesPanel').classList.add('hidden');
        }
        
        function addToFavorites(btn) {
            const icon = btn.querySelector('i');
            if (icon.classList.contains('text-white')) {
                icon.classList.remove('text-white');
                icon.classList.add('text-pink-500');
                alert('Added to favorites!');
            } else {
                icon.classList.remove('text-pink-500');
                icon.classList.add('text-white');
                alert('Removed from favorites!');
            }
        }
        
        function removeFromFavorites(btn) {
            // Get parent favorite item and remove it
            const item = btn.closest('.favorite-item');
            item.remove();
            alert('Removed from favorites!');
        }
        
        // Commission request system
        function openCommissionModal(artistId) {
            // Create and show commission request modal
            const modal = document.createElement('div');
            modal.id = 'commissionModal';
            modal.className = 'fixed inset-0 bg-black/90 z-[100] flex items-center justify-center';
            modal.innerHTML = `
                <div class="bg-gray-900 p-6 rounded-xl w-full max-w-md mx-4">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold">Request a Commission</h2>
                        <button onclick="closeCommissionModal()" class="p-1 rounded-full hover:bg-gray-700">
                            <i class="fas fa-times text-lg"></i>
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-1">Commission Type</label>
                            <select class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                                <option value="painting">Painting</option>
                                <option value="digital">Digital Art</option>
                                <option value="sculpture">Sculpture</option>
                                <option value="music">Music</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Description</label>
                            <textarea class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500 h-24"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Budget (₱)</label>
                            <input type="number" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Deadline</label>
                            <input type="date" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                        </div>
                        <button onclick="submitCommissionRequest()" class="w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white py-2 rounded-lg font-medium hover:from-pink-600 hover:to-purple-700 transition-all">
                            Submit Request
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        function closeCommissionModal() {
            const modal = document.getElementById('commissionModal');
            if (modal) modal.remove();
        }
        
        function submitCommissionRequest() {
            alert('Commission request sent! The artist will contact you soon.');
            closeCommissionModal();
        }
        
        // Payment integration
        function openPaymentModal(amount, description) {
            // Create and show payment modal
            const modal = document.createElement('div');
            modal.id = 'paymentModal';
            modal.className = 'fixed inset-0 bg-black/90 z-[100] flex items-center justify-center';
            modal.innerHTML = `
                <div class="bg-gray-900 p-6 rounded-xl w-full max-w-md mx-4">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold">Complete Payment</h2>
                        <button onclick="closePaymentModal()" class="p-1 rounded-full hover:bg-gray-700">
                            <i class="fas fa-times text-lg"></i>
                        </button>
                    </div>
                    
                    <div class="mb-6 p-4 bg-gray-800 rounded-lg">
                        <div class="flex justify-between items-center">
                            <span class="text-sm">Amount</span>
                            <span class="text-lg font-bold">₱${amount}</span>
                        </div>
                        <div class="text-sm text-gray-400">${description}</div>
                    </div>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-1">Payment Method</label>
                            <div class="grid grid-cols-3 gap-3 mb-4">
                                <button class="p-3 bg-gray-800 rounded-lg border border-pink-500 flex items-center justify-center">
                                    <i class="fab fa-cc-visa text-2xl"></i>
                                </button>
                                <button class="p-3 bg-gray-800 rounded-lg border border-gray-700 flex items-center justify-center">
                                    <i class="fab fa-cc-mastercard text-2xl"></i>
                                </button>
                                <button class="p-3 bg-gray-800 rounded-lg border border-gray-700 flex items-center justify-center">
                                    <i class="fab fa-paypal text-2xl"></i>
                                </button>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Card Number</label>
                            <input type="text" placeholder="1234 5678 9012 3456" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-1">Expiry Date</label>
                                <input type="text" placeholder="MM/YY" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1">CVC</label>
                                <input type="text" placeholder="123" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                            </div>
                        </div>
                        <button onclick="processPayment(${amount})" class="w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white py-2 rounded-lg font-medium hover:from-pink-600 hover:to-purple-700 transition-all">
                            Pay ₱${amount}
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        function closePaymentModal() {
            const modal = document.getElementById('paymentModal');
            if (modal) modal.remove();
        }
        
        function processPayment(amount) {
            alert(`Payment of ₱${amount} processed successfully!`);
            closePaymentModal();
        }
        
        // Shopping cart functionality
        let cartItems = [];
        
        function toggleShoppingCart() {
            document.getElementById('shoppingCartPanel').classList.toggle('hidden');
        }
        
        function closeShoppingCart() {
            document.getElementById('shoppingCartPanel').classList.add('hidden');
        }
        
        function addToCart(product, price, image) {
            // Create a unique ID for the product
            const productId = Date.now();
            
            // Add to cart items array
            cartItems.push({
                id: productId,
                product: product,
                price: price,
                quantity: 1,
                image: image || 'https://via.placeholder.com/50'
            });
            
            // Update cart badge
            updateCartBadge();
            
            // Show notification
            showToast(`${product} added to cart!`);
        }
        
        function updateCartBadge() {
            const badge = document.getElementById('cartCountBadge');
            
            if (cartItems.length > 0) {
                badge.textContent = cartItems.length;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
        }
        
        function showToast(message) {
            // Create and show toast notification
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-4 right-4 bg-gradient-to-r from-pink-500 to-purple-600 text-white px-4 py-2 rounded-lg shadow-lg z-[200]';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            // Remove after 3 seconds
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
        
        function updateCartDisplay() {
            const cartItemsList = document.getElementById('cartItemsList');
            const cartEmptyMessage = document.getElementById('cartEmptyMessage');
            const cartItemsContainer = document.getElementById('cartItems');
            const subtotalElement = document.getElementById('cartSubtotal');
            const totalElement = document.getElementById('cartTotal');
            
            // Clear current items
            cartItemsList.innerHTML = '';
            
            if (cartItems.length === 0) {
                cartEmptyMessage.classList.remove('hidden');
                cartItemsContainer.classList.add('hidden');
                return;
            }
            
            // Show items container, hide empty message
            cartEmptyMessage.classList.add('hidden');
            cartItemsContainer.classList.remove('hidden');
            
            // Calculate subtotal
            let subtotal = 0;
            
            // Add each item to the cart display
            cartItems.forEach(item => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;
                
                const itemElement = document.createElement('div');
                itemElement.className = 'flex items-center p-3 bg-gray-800 rounded-lg';
                itemElement.innerHTML = `
                    <img src="${item.image}" alt="${item.product}" class="w-12 h-12 rounded object-cover mr-3">
                    <div class="flex-1">
                        <div class="flex justify-between">
                            <span class="font-medium">${item.product}</span>
                            <span>₱${itemTotal.toLocaleString()}</span>
                        </div>
                        <div class="flex items-center mt-1">
                            <button class="p-1 bg-gray-700 rounded" onclick="decreaseQuantity(${item.id})">
                                <i class="fas fa-minus text-xs"></i>
                            </button>
                            <span class="mx-2">${item.quantity}</span>
                            <button class="p-1 bg-gray-700 rounded" onclick="increaseQuantity(${item.id})">
                                <i class="fas fa-plus text-xs"></i>
                            </button>
                            <button class="ml-auto p-1 text-gray-400 hover:text-red-500" onclick="removeFromCart(${item.id})">
                                <i class="fas fa-trash text-sm"></i>
                            </button>
                        </div>
                    </div>
                `;
                cartItemsList.appendChild(itemElement);
            });
            
            // Update totals
            subtotalElement.textContent = `₱${subtotal.toLocaleString()}`;
            totalElement.textContent = `₱${(subtotal + 150).toLocaleString()}`;
        }
        
        function increaseQuantity(itemId) {
            const item = cartItems.find(item => item.id === itemId);
            if (item) {
                item.quantity++;
                updateCartDisplay();
            }
        }
        
        function decreaseQuantity(itemId) {
            const item = cartItems.find(item => item.id === itemId);
            if (item && item.quantity > 1) {
                item.quantity--;
                updateCartDisplay();
            }
        }
        
        function removeFromCart(itemId) {
            cartItems = cartItems.filter(item => item.id !== itemId);
            updateCartBadge();
            updateCartDisplay();
        }
        
        function proceedToCheckout() {
            // Hide cart panel, show checkout panel
            document.getElementById('shoppingCartPanel').classList.add('hidden');
            document.getElementById('checkoutPanel').classList.remove('hidden');
            
            // Update checkout items summary
            updateCheckoutSummary();
        }
        
        function backToCart() {
            // Hide checkout panel, show cart panel
            document.getElementById('checkoutPanel').classList.add('hidden');
            document.getElementById('shoppingCartPanel').classList.remove('hidden');
        }
        
        function updateCheckoutSummary() {
            const checkoutItemsList = document.getElementById('checkoutItemsList');
            const subtotalElement = document.getElementById('checkoutSubtotal');
            const totalElement = document.getElementById('checkoutTotal');
            
            // Clear current items
            checkoutItemsList.innerHTML = '';
            
            // Calculate subtotal
            let subtotal = 0;
            
            // Add each item to the checkout summary
            cartItems.forEach(item => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;
                
                const itemElement = document.createElement('div');
                itemElement.className = 'flex justify-between items-center';
                itemElement.innerHTML = `
                    <span class="text-sm">${item.product} x ${item.quantity}</span>
                    <span class="text-sm font-medium">₱${itemTotal.toLocaleString()}</span>
                `;
                checkoutItemsList.appendChild(itemElement);
            });
            
            // Update totals
            subtotalElement.textContent = `₱${subtotal.toLocaleString()}`;
            totalElement.textContent = `₱${(subtotal + 150).toLocaleString()}`;
        }
        
        function completeOrder() {
            alert('Thank you for your order! Your payment has been processed successfully.');
            
            // Clear cart
            cartItems = [];
            updateCartBadge();
            
            // Hide checkout panel
            document.getElementById('checkoutPanel').classList.add('hidden');
        }
        
        // Initialize cart when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            updateCartBadge();
            
            // Add click handlers to all "Add to Cart" buttons
            document.querySelectorAll('.add-to-cart-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const product = this.dataset.product;
                    const price = parseFloat(this.dataset.price);
                    const image = this.dataset.image;
                    addToCart(product, price, image);
                });
            });
        });
        
        // Filter by category
        function filterByCategory(category) {
            // Update active category
            document.querySelectorAll('.category-pill').forEach(pill => {
                if (pill.dataset.category === category) {
                    pill.classList.add('active');
                } else {
                    pill.classList.remove('active');
                }
            });
            
            // Implement filtering logic here
            console.log(`Filtering by category: ${category}`);
            
            // If category is busking, show tip buttons
            if (category === 'busking') {
                document.querySelectorAll('.tip-btn').forEach(btn => {
                    btn.style.display = 'block';
                });
            } else {
                document.querySelectorAll('.tip-btn').forEach(btn => {
                    btn.style.display = 'none';
                });
            }
        }
        
        // Show services subcategories
        function showServicesSubcategories() {
            const servicesBtn = document.querySelector('.services-btn');
            const servicesSubcategories = document.getElementById('servicesSubcategories');
            
            // Toggle visibility
            if (servicesSubcategories.classList.contains('hidden')) {
                servicesSubcategories.classList.remove('hidden');
            } else {
                servicesSubcategories.classList.add('hidden');
            }
        }
        
        function selectServiceCategory(category) {
            // Hide the subcategories panel
            document.getElementById('servicesSubcategories').classList.add('hidden');
            
            // Update selected category
            alert(`Selected service category: ${category}`);
            
            // If busking is selected, show tip buttons
            if (category === 'busking') {
                document.querySelectorAll('.tip-btn').forEach(btn => {
                    btn.style.display = 'block';
                });
            }
        }
        
        function openTipModal(button) {
            const artistName = button.dataset.artist;
            
            // Create and show tip modal
            const modal = document.createElement('div');
            modal.id = 'tipModal';
            modal.className = 'fixed inset-0 bg-black/90 z-[100] flex items-center justify-center';
            modal.innerHTML = `
                <div class="bg-gray-900 p-6 rounded-xl w-full max-w-md mx-4">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold">Send a Tip to ${artistName}</h2>
                        <button onclick="closeTipModal()" class="p-1 rounded-full hover:bg-gray-700">
                            <i class="fas fa-times text-lg"></i>
                        </button>
                    </div>
                    
                    <div class="mb-6 text-center">
                        <div class="text-sm mb-2">Select an amount or enter custom amount</div>
                        <div class="grid grid-cols-3 gap-3 mb-4">
                            <button class="p-3 bg-gray-800 rounded-lg border border-gray-700 hover:border-pink-500 tip-amount-btn" data-amount="50">₱50</button>
                            <button class="p-3 bg-gray-800 rounded-lg border border-gray-700 hover:border-pink-500 tip-amount-btn" data-amount="100">₱100</button>
                            <button class="p-3 bg-gray-800 rounded-lg border border-gray-700 hover:border-pink-500 tip-amount-btn" data-amount="200">₱200</button>
                            <button class="p-3 bg-gray-800 rounded-lg border border-gray-700 hover:border-pink-500 tip-amount-btn" data-amount="500">₱500</button>
                            <button class="p-3 bg-gray-800 rounded-lg border border-gray-700 hover:border-pink-500 tip-amount-btn" data-amount="1000">₱1,000</button>
                            <button class="p-3 bg-gray-800 rounded-lg border border-gray-700 hover:border-pink-500 flex items-center justify-center custom-tip-btn">
                                <i class="fas fa-plus mr-1"></i> Custom
                            </button>
                        </div>
                        <div id="customTipInput" class="hidden mb-4">
                            <input type="number" placeholder="Enter amount" class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500">
                        </div>
                    </div>
                    
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-1">Add a message (optional)</label>
                        <textarea class="w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-pink-500 h-16"></textarea>
                    </div>
                    
                    <button onclick="sendTip(100)" class="w-full bg-gradient-to-r from-pink-500 to-purple-600 text-white py-2 rounded-lg font-medium hover:from-pink-600 hover:to-purple-700 transition-all">
                        Send Tip
                    </button>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Add event listeners to tip amount buttons
            setTimeout(() => {
                document.querySelectorAll('.tip-amount-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        document.querySelectorAll('.tip-amount-btn').forEach(b => b.classList.remove('border-pink-500'));
                        this.classList.add('border-pink-500');
                        document.querySelector('#tipModal button:last-child').innerText = `Send Tip (₱${this.dataset.amount})`;
                    });
                });
                
                document.querySelector('.custom-tip-btn').addEventListener('click', function() {
                    document.getElementById('customTipInput').classList.toggle('hidden');
                });
            }, 100);
        }
        
        function closeTipModal() {
            const modal = document.getElementById('tipModal');
            if (modal) modal.remove();
        }
        
        function sendTip(amount) {
            alert(`Thank you for your tip of ₱${amount}!`);
            closeTipModal();
        }
        
        // Artist Portfolio Page
        function viewArtistPortfolio(username) {
            // Create and show artist portfolio modal
            const modal = document.createElement('div');
            modal.id = 'artistPortfolioModal';
            modal.className = 'fixed inset-0 bg-black/90 z-[100] flex items-center justify-center overflow-y-auto';
            modal.innerHTML = `
                <div class="bg-gray-900 w-full max-w-4xl max-h-[90vh] overflow-y-auto rounded-xl mx-4">
                    <!-- Artist Header -->
                    <div class="relative h-64 bg-gradient-to-r from-purple-900 to-pink-900">
                        <button onclick="closeArtistPortfolio()" class="absolute top-4 right-4 p-2 bg-black/50 rounded-full hover:bg-black/70">
                            <i class="fas fa-times text-lg"></i>
                        </button>
                        <div class="absolute -bottom-16 left-6">
                            <img src="https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop" 
                                alt="Artist" class="w-32 h-32 rounded-full border-4 border-gray-900">
                        </div>
                    </div>
                    
                    <!-- Artist Info -->
                    <div class="mt-20 px-6 pb-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <h2 class="text-2xl font-bold">@artista_maya</h2>
                                <p class="text-gray-400">Digital Artist | 3D Designer</p>
                            </div>
                            <div class="flex space-x-3">
                                <button class="px-4 py-2 bg-gradient-to-r from-pink-500 to-purple-600 rounded-full text-sm font-medium hover:from-pink-600 hover:to-purple-700 transition-all">
                                    Follow
                                </button>
                                <button class="px-4 py-2 bg-gray-800 rounded-full text-sm font-medium hover:bg-gray-700" onclick="openCommissionModal('artista_maya')">
                                    <i class="fas fa-palette mr-1"></i> Commission
                                </button>
                                <button class="px-4 py-2 bg-gray-800 rounded-full text-sm font-medium hover:bg-gray-700" onclick="openMessagesPanel()">
                                    <i class="fas fa-comment mr-1"></i> Message
                                </button>
                            </div>
                        </div>
                        
                        <!-- Artist Stats -->
                        <div class="flex space-x-6 mt-4">
                            <div class="text-center">
                                <div class="text-xl font-bold">248</div>
                                <div class="text-sm text-gray-400">Artworks</div>
                            </div>
                            <div class="text-center">
                                <div class="text-xl font-bold">15.7K</div>
                                <div class="text-sm text-gray-400">Followers</div>
                            </div>
                            <div class="text-center">
                                <div class="text-xl font-bold">1.2K</div>
                                <div class="text-sm text-gray-400">Following</div>
                            </div>
                            <div class="text-center">
                                <div class="text-xl font-bold">98%</div>
                                <div class="text-sm text-gray-400">Completion</div>
                            </div>
                        </div>
                        
                        <!-- Artist Bio -->
                        <div class="mt-6 p-4 bg-gray-800 rounded-lg">
                            <p>Digital artist specializing in concept art and character design. I love creating immersive worlds and bringing characters to life. Available for commissions and collaborations.</p>
                            <div class="flex items-center mt-2 text-sm text-gray-400">
                                <i class="fas fa-map-marker-alt mr-1"></i> Manila, Philippines
                                <span class="mx-2">•</span>
                                <i class="fas fa-calendar-alt mr-1"></i> Joined 2023
                            </div>
                        </div>
                        
                        <!-- Portfolio Categories -->
                        <div class="mt-6">
                            <div class="flex items-center space-x-4 mb-4 overflow-x-auto pb-2">
                                <button class="px-4 py-1 bg-gray-800 rounded-full text-sm font-medium active-category">All Works</button>
                                <button class="px-4 py-1 bg-gray-800 rounded-full text-sm font-medium">Digital Art</button>
                                <button class="px-4 py-1 bg-gray-800 rounded-full text-sm font-medium">Paintings</button>
                                <button class="px-4 py-1 bg-gray-800 rounded-full text-sm font-medium">Commissions</button>
                                <button class="px-4 py-1 bg-gray-800 rounded-full text-sm font-medium">For Sale</button>
                            </div>
                            
                            <!-- Portfolio Grid -->
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                                <div class="aspect-square bg-gradient-to-br from-purple-900 to-blue-900 rounded-lg overflow-hidden relative cursor-pointer">
                                    <div class="absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 bg-black/70 transition-opacity">
                                        <div class="text-center">
                                            <div class="text-sm font-medium mb-1">Abstract Dreams</div>
                                            <div class="text-xs text-gray-400">₱8,500</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="aspect-square bg-gradient-to-br from-green-900 to-teal-900 rounded-lg overflow-hidden relative cursor-pointer">
                                    <div class="absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 bg-black/70 transition-opacity">
                                        <div class="text-center">
                                            <div class="text-sm font-medium mb-1">Ocean Melody</div>
                                            <div class="text-xs text-gray-400">₱12,000</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="aspect-square bg-gradient-to-br from-red-900 to-orange-900 rounded-lg overflow-hidden relative cursor-pointer">
                                    <div class="absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 bg-black/70 transition-opacity">
                                        <div class="text-center">
                                            <div class="text-sm font-medium mb-1">Fire Spirit</div>
                                            <div class="text-xs text-gray-400">₱9,200</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="aspect-square bg-gradient-to-br from-blue-900 to-cyan-900 rounded-lg overflow-hidden relative cursor-pointer">
                                    <div class="absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 bg-black/70 transition-opacity">
                                        <div class="text-center">
                                            <div class="text-sm font-medium mb-1">Deep Blue</div>
                                            <div class="text-xs text-gray-400">₱7,500</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="aspect-square bg-gradient-to-br from-yellow-900 to-amber-900 rounded-lg overflow-hidden relative cursor-pointer">
                                    <div class="absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 bg-black/70 transition-opacity">
                                        <div class="text-center">
                                            <div class="text-sm font-medium mb-1">Golden Hour</div>
                                            <div class="text-xs text-gray-400">₱11,000</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="aspect-square bg-gradient-to-br from-pink-900 to-rose-900 rounded-lg overflow-hidden relative cursor-pointer">
                                    <div class="absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 bg-black/70 transition-opacity">
                                        <div class="text-center">
                                            <div class="text-sm font-medium mb-1">Rose Garden</div>
                                            <div class="text-xs text-gray-400">₱10,500</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Load More Button -->
                            <div class="text-center mt-6">
                                <button class="px-6 py-2 bg-gray-800 rounded-full text-sm font-medium hover:bg-gray-700">
                                    Load More
                                </button>
                            </div>
                        </div>
                        
                        <!-- Reviews Section -->
                        <div class="mt-8">
                            <h3 class="text-lg font-semibold mb-4">Reviews & Feedback</h3>
                            <div class="space-y-4">
                                <div class="bg-gray-800 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <img src="https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=30&h=30&fit=crop" 
                                             alt="User" class="w-10 h-10 rounded-full">
                                        <div>
                                            <div class="flex items-center">
                                                <span class="font-medium">@user1</span>
                                                <span class="mx-2 text-gray-500">•</span>
                                                <div class="flex">
                                                    <i class="fas fa-star text-yellow-500"></i>
                                                    <i class="fas fa-star text-yellow-500"></i>
                                                    <i class="fas fa-star text-yellow-500"></i>
                                                    <i class="fas fa-star text-yellow-500"></i>
                                                    <i class="fas fa-star text-yellow-500"></i>
                                                </div>
                                            </div>
                                            <p class="text-sm mt-1">Incredible artist! The commission was completed quickly and exceeded my expectations. Will definitely work with again!</p>
                                            <span class="text-xs text-gray-500 mt-1 block">2 months ago</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="bg-gray-800 rounded-lg p-4">
                                    <div class="flex items-start space-x-3">
                                        <img src="https://images.pexels.com/photos/1239291/pexels-photo-1239291.jpeg?auto=compress&cs=tinysrgb&w=30&h=30&fit=crop" 
                                             alt="User" class="w-10 h-10 rounded-full">
                                        <div>
                                            <div class="flex items-center">
                                                <span class="font-medium">@user2</span>
                                                <span class="mx-2 text-gray-500">•</span>
                                                <div class="flex">
                                                    <i class="fas fa-star text-yellow-500"></i>
                                                    <i class="fas fa-star text-yellow-500"></i>
                                                    <i class="fas fa-star text-yellow-500"></i>
                                                    <i class="fas fa-star text-yellow-500"></i>
                                                    <i class="far fa-star text-yellow-500"></i>
                                                </div>
                                            </div>
                                            <p class="text-sm mt-1">Amazing work as always! Great communication throughout the process.</p>
                                            <span class="text-xs text-gray-500 mt-1 block">1 month ago</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }
        
        function closeArtistPortfolio() {
            const modal = document.getElementById('artistPortfolioModal');
            if (modal) modal.remove();
        }
        
        // Ensure all 'Request Service' buttons open the luthier request modal
        // Use event delegation for dynamically rendered or multiple buttons with the same class
        
        document.addEventListener('click', function(e) {
            if (e.target.closest('.buy-btn') && e.target.closest('.product-card[data-subcategory="guitar-luthier"]')) {
                openLuthierForm();
            }
        });
        
        // Add Product Modal - Show/hide Condition field based on selected category
        const productCategorySelect = document.getElementById('productCategory');
        if (productCategorySelect) {
            productCategorySelect.addEventListener('change', function () {
                const conditionContainer = document.getElementById('productConditionContainer');
                const conditionSelect = document.getElementById('productCondition');
                if (this.value === 'musical-instruments') {
                    conditionContainer.style.display = 'block';
                    conditionSelect.required = true;
                } else {
                    conditionContainer.style.display = 'none';
                    conditionSelect.required = false;
                    conditionSelect.value = ''; // Reset value when hidden
                }
            });
        }
        
        // Estimated Duration formatting logic
        const durationInput = document.getElementById('luthierDurationDays');
        const durationFormatted = document.getElementById('durationFormatted');
        
        if (durationInput) {
            durationInput.addEventListener('input', function() {
                const days = parseInt(durationInput.value, 10);
                if (!days || days < 1) {
                    durationFormatted.textContent = '';
                    return;
                }
                const weeks = Math.floor(days / 7);
                const remDays = days % 7;
                let formatted = '';
                if (weeks > 0) {
                    formatted += weeks + (weeks === 1 ? ' week' : ' weeks');
                }
                if (remDays > 0) {
                    if (weeks > 0) formatted += ' and ';
                    formatted += remDays + (remDays === 1 ? ' day' : ' days');
                }
                // Calculate end date
                const today = new Date();
                const endDate = new Date(today);
                endDate.setDate(today.getDate() + days);
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                formatted += ` (Ends on ${endDate.toLocaleDateString(undefined, options)})`;
                durationFormatted.textContent = formatted;
            });
        }
        
        
        
        // My Shop Content
        document.addEventListener('DOMContentLoaded', function() {
            // Show/hide Condition field based on Category selection in "Add Product" modal
            const productCategory = document.getElementById('productCategory');
            if (productCategory) {
                productCategory.addEventListener('change', function() {
                    const conditionContainer = document.getElementById('productConditionContainer');
                    if (this.value === 'musical-instruments') { // <-- Changed to plural
                        conditionContainer.style.display = 'block';
                    } else {
                        conditionContainer.style.display = 'none';
                    }
                });
            }
        });
        
        // Category Carousel Function
        function scrollCategories(direction) {
            const container = document.getElementById('categoriesContainer');
            const scrollAmount = 200; // Adjust this value to control scroll distance
            
            if (direction === 'left') {
                container.scrollBy({
                    left: -scrollAmount,
                    behavior: 'smooth'
                });
            } else if (direction === 'right') {
                container.scrollBy({
                    left: scrollAmount,
                    behavior: 'smooth'
                });
            }
        }
        
        // Show/hide instrument condition filter
        const instrumentCategoryBtn = document.querySelector('.category-btn[data-category="instruments"]');
        const instrumentConditionFilter = document.getElementById('instrumentConditionFilter');
        
        if (instrumentCategoryBtn && instrumentConditionFilter) {
            document.querySelectorAll('.category-btn').forEach(button => {
                button.addEventListener('click', () => {
                    if (button.dataset.category === 'instruments') {
                        instrumentConditionFilter.style.display = 'block';
                    } else if (button.dataset.category !== 'services') {
                        instrumentConditionFilter.style.display = 'none';
                    }
                });
            });
        }
        
        function toggleInstrumentConditionDropdown() {
            const dropdown = document.getElementById('instrumentConditionDropdown');
            dropdown.classList.toggle('hidden');
        }
        
        // Instrument condition subcategory filtering
        document.querySelectorAll('.instrument-condition-subcategory').forEach(button => {
            button.addEventListener('click', function() {
                const subcategory = this.dataset.subcategory;
                const products = document.querySelectorAll('.product-card');
                
                products.forEach(product => {
                    if (product.dataset.category === 'instruments' && (product.dataset.condition === subcategory || subcategory === 'all')) {
                        product.style.display = 'block';
                    } else if (product.dataset.category !== 'instruments') {
                        // Keep non-instrument items hidden
                    }
                    else {
                        product.style.display = 'none';
                    }
                });
                
                document.getElementById('instrumentConditionDropdown').classList.add('hidden');
            });
        });
    </script>
<!-- ===== Shop Module: Top Navigation Buttons (Append to Shop Top Nav) ===== -->
<script>
document.addEventListener("DOMContentLoaded", function () {
  // 1. Top Navigation Button Injection (with modals/panels for each)
  const shopNav = document.querySelector("#shop-content .flex.justify-center.space-x-4");
  if (shopNav) {
    // Remove old nav if any, then inject new nav
    shopNav.innerHTML = `
      <button id="shop-voucher-btn" class="top-nav-item px-4 py-2 rounded-full text-sm font-medium hover:scale-105 transition-all"><i class="fas fa-ticket-alt mr-2"></i>Voucher</button>
      <button id="shop-orders-btn" class="top-nav-item px-4 py-2 rounded-full text-sm font-medium hover:scale-105 transition-all"><i class="fas fa-box mr-2"></i>Orders</button>
      <button id="shop-payment-btn" class="top-nav-item px-4 py-2 rounded-full text-sm font-medium hover:scale-105 transition-all"><i class="fas fa-credit-card mr-2"></i>Payment</button>
      <button id="shop-messages-btn" class="top-nav-item px-4 py-2 rounded-full text-sm font-medium hover:scale-105 transition-all"><i class="fas fa-envelope mr-2"></i>Messages</button>
      <button id="shop-returns-btn" class="top-nav-item px-4 py-2 rounded-full text-sm font-medium hover:scale-105 transition-all"><i class="fas fa-undo mr-2"></i>Returns</button>
      <button id="shop-address-btn" class="top-nav-item px-4 py-2 rounded-full text-sm font-medium hover:scale-105 transition-all"><i class="fas fa-map-marked-alt mr-2"></i>Address</button>
    `;
  }

  // 2. Add event listeners for each button to open modals/panels
  function showShopModal(id, contentHTML, onOpen) {
    let modal = document.getElementById(id);
    if (!modal) {
      modal = document.createElement("div");
      modal.id = id;
      modal.className = "fixed inset-0 bg-black/80 z-[200] flex items-center justify-center";
      modal.innerHTML = `
        <div class="bg-gray-900 p-6 rounded-xl w-full max-w-md mx-4 relative">
          <button onclick="document.getElementById('${id}').remove();" class="absolute top-4 right-4 p-1 rounded-full hover:bg-gray-700">
            <i class="fas fa-times text-lg"></i>
          </button>
          ${contentHTML}
        </div>
      `;
      document.body.appendChild(modal);
    }
    if (onOpen) onOpen(modal);
  }

  // Voucher Button
  document.getElementById("shop-voucher-btn").onclick = function () {
    showShopModal(
      "shopVoucherModal",
      `
      <h2 class="text-xl font-bold mb-4">My Vouchers</h2>
      <div id="voucher-list" class="mb-4"></div>
      <form id="voucher-redeem-form" class="flex gap-2">
        <input type="text" id="voucher-code-input" placeholder="Enter voucher code..." class="flex-1 bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm" />
        <button type="submit" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">Redeem</button>
      </form>
      <div id="voucher-message" class="mt-2 text-sm"></div>
      `,
      function (modal) {
        // Fetch and render available vouchers (API)
        fetch("/api/vouchers")
          .then(resp => resp.json())
          .then(data => {
            const list = modal.querySelector("#voucher-list");
            if (data.length === 0) {
              list.innerHTML = `<div class="text-gray-400">No vouchers available.</div>`;
            } else {
              list.innerHTML = data.map(v =>
                `<div class="bg-gray-800 rounded-lg px-4 py-2 mb-2 flex justify-between items-center">
                  <div>
                    <span class="font-semibold">${v.code}</span>
                    <span class="ml-2 text-xs text-gray-400">${v.description}</span>
                    <span class="ml-2 text-xs text-green-400">${v.discount}% OFF</span>
                  </div>
                  <button onclick="navigator.clipboard.writeText('${v.code}')" class="text-xs bg-gray-700 rounded px-2 py-1">Copy</button>
                </div>`
              ).join("");
            }
          });
        // Voucher redeem form submit
        modal.querySelector("#voucher-redeem-form").onsubmit = function (e) {
          e.preventDefault();
          const code = modal.querySelector("#voucher-code-input").value.trim();
          fetch("/api/vouchers/redeem", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ code })
          }).then(r => r.json())
            .then(resp => {
              modal.querySelector("#voucher-message").textContent = resp.message || (resp.success ? "Voucher redeemed!" : "Invalid voucher.");
              if (resp.success) setTimeout(() => modal.remove(), 1500);
            })
            .catch(() => { modal.querySelector("#voucher-message").textContent = "Error redeeming voucher."; });
        };
      }
    );
  };

  // Orders Button
  document.getElementById("shop-orders-btn").onclick = function () {
    showShopModal(
      "shopOrdersModal",
      `
      <h2 class="text-xl font-bold mb-4">My Orders</h2>
      <div id="order-list" class="space-y-4"></div>
      `,
      function (modal) {
        fetch("/api/orders")
          .then(resp => resp.json())
          .then(data => {
            const list = modal.querySelector("#order-list");
            if (!data.length) {
              list.innerHTML = `<div class="text-gray-400">No orders found.</div>`;
            } else {
              list.innerHTML = data.map(order => `
                <div class="bg-gray-800 rounded-lg p-4">
                  <div class="flex justify-between items-center mb-2">
                    <span class="font-semibold">Order #${order.id}</span>
                    <span class="text-xs ${order.status === 'Delivered' ? 'text-green-400' : 'text-yellow-400'}">${order.status}</span>
                  </div>
                  <div class="text-xs text-gray-400 mb-1">${order.date}</div>
                  <div class="text-sm mb-2">${order.items.map(i => `${i.title} x${i.qty}`).join(", ")}</div>
                  <div class="font-bold text-purple-400">₱${order.total.toLocaleString()}</div>
                  <button onclick="fetch('/api/orders/${order.id}/details').then(r=>r.json()).then(d=>alert(JSON.stringify(d,null,2)))" class="mt-2 text-xs px-3 py-1 bg-gray-700 rounded">View Details</button>
                </div>
              `).join("");
            }
          });
      }
    );
  };

  // Payment Button
  document.getElementById("shop-payment-btn").onclick = function () {
    showShopModal(
      "shopPaymentModal",
      `
      <h2 class="text-xl font-bold mb-4">Payment Methods</h2>
      <div id="payment-methods-list"></div>
      <button id="add-payment-method-btn" class="mt-4 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">Add Method</button>
      `,
      function (modal) {
        function loadMethods() {
          fetch("/api/payments/methods")
            .then(resp => resp.json())
            .then(data => {
              const list = modal.querySelector("#payment-methods-list");
              if (!data.length) {
                list.innerHTML = `<div class="text-gray-400">No payment methods saved.</div>`;
              } else {
                list.innerHTML = data.map(pm => `
                  <div class="bg-gray-800 rounded-lg px-4 py-2 mb-2 flex justify-between items-center">
                    <span>${pm.type === 'paypal' ? '<i class="fab fa-paypal text-blue-400"></i>' : pm.type === 'gcash' ? '<img src="https://upload.wikimedia.org/wikipedia/commons/0/09/GCash_logo.png" alt="GCash" style="height:20px;display:inline;margin-right:4px;">' : '<i class="fas fa-credit-card"></i>'}
                    ${pm.details}</span>
                    <button onclick="fetch('/api/payments/methods/${pm.id}',{method:'DELETE'}).then(()=>loadMethods())" class="text-xs bg-gray-700 rounded px-2 py-1">Remove</button>
                  </div>
                `).join("");
              }
            });
        }
        loadMethods();
        modal.querySelector("#add-payment-method-btn").onclick = function () {
          // Example: show add method form (could be modal, stubbed for now)
          alert("Show Add Payment Method Form (GCash, PayPal, Card, etc).");
        };
      }
    );
  };

  // Messages Button
  document.getElementById("shop-messages-btn").onclick = function () {
    showShopModal(
      "shopMessagesModal",
      `
      <h2 class="text-xl font-bold mb-4">Shop Messages</h2>
      <div id="shop-messages-list" class="space-y-3"></div>
      `,
      function (modal) {
        fetch("/api/messages")
          .then(resp => resp.json())
          .then(data => {
            const list = modal.querySelector("#shop-messages-list");
            if (!data.length) {
              list.innerHTML = `<div class="text-gray-400">No messages.</div>`;
            } else {
              list.innerHTML = data.map(msg =>
                `<div class="bg-gray-800 rounded-lg p-3">
                  <div class="flex justify-between items-center mb-1">
                    <span class="font-semibold">${msg.title}</span>
                    <span class="text-xs text-gray-400">${new Date(msg.date).toLocaleString()}</span>
                  </div>
                  <div class="text-gray-300 text-sm">${msg.body}</div>
                </div>`
              ).join("");
            }
          });
      }
    );
  };

  // Returns Button
  document.getElementById("shop-returns-btn").onclick = function () {
    showShopModal(
      "shopReturnsModal",
      `
      <h2 class="text-xl font-bold mb-4">Return Requests</h2>
      <div id="returns-list" class="mb-4"></div>
      <button id="create-return-btn" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 transition">Request Return</button>
      `,
      function (modal) {
        function loadReturns() {
          fetch("/api/returns")
            .then(r => r.json())
            .then(data => {
              const list = modal.querySelector("#returns-list");
              if (!data.length) {
                list.innerHTML = `<div class="text-gray-400">No return requests.</div>`;
              } else {
                list.innerHTML = data.map(ret =>
                  `<div class="bg-gray-800 rounded-lg p-3 mb-2">
                    <div class="flex justify-between items-center mb-1">
                      <span>Order #${ret.order_id}</span>
                      <span class="text-xs text-yellow-400">${ret.status}</span>
                    </div>
                    <div class="text-xs text-gray-400">Reason: ${ret.reason}</div>
                  </div>`
                ).join("");
              }
            });
        }
        loadReturns();
        modal.querySelector("#create-return-btn").onclick = function () {
          // Show a simple prompt for demo
          const orderId = prompt("Enter Order ID for return:");
          const reason = prompt("Reason for return:");
          if (!orderId || !reason) return;
          fetch("/api/returns", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ order_id: orderId, reason })
          }).then(() => loadReturns());
        };
      }
    );
  };

  // Address Button
  document.getElementById("shop-address-btn").onclick = function () {
    showShopModal(
      "shopAddressModal",
      `
      <h2 class="text-xl font-bold mb-4">Manage Addresses</h2>
      <div id="address-list"></div>
      <button id="add-address-btn" class="mt-4 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">Add Address</button>
      `,
      function (modal) {
        function loadAddresses() {
          fetch("/api/addresses")
            .then(r => r.json())
            .then(data => {
              const list = modal.querySelector("#address-list");
              if (!data.length) {
                list.innerHTML = `<div class="text-gray-400">No addresses found.</div>`;
              } else {
                list.innerHTML = data.map(addr =>
                  `<div class="bg-gray-800 rounded-lg px-4 py-2 mb-2 flex justify-between items-center">
                    <div>
                      <div class="font-semibold">${addr.label || addr.name}</div>
                      <div class="text-xs text-gray-400">${addr.address}, ${addr.city}, ${addr.postal} <span class="ml-1">${addr.type ? '(' + addr.type + ')' : ''}</span></div>
                    </div>
                    <button onclick="fetch('/api/addresses/${addr.id}',{method:'DELETE'}).then(()=>loadAddresses())" class="text-xs bg-gray-700 rounded px-2 py-1">Delete</button>
                  </div>`
                ).join("");
              }
            });
        }
        loadAddresses();
        modal.querySelector("#add-address-btn").onclick = function () {
          // Show a simple prompt for demo
          const name = prompt("Name/Label:");
          const address = prompt("Address:");
          const city = prompt("City:");
          const postal = prompt("Postal Code:");
          if (!name || !address || !city || !postal) return;
          fetch("/api/addresses", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name, address, city, postal })
          }).then(() => loadAddresses());
        };
      }
    );
  };

  // ========== CATEGORIES & SUBCATEGORIES ==========
  // Move search bar below categories and make categories dynamic
  const mktContent = document.getElementById('marketplace-content');
  if (mktContent) {
    // Remove old categories and search bar
    const oldCat = mktContent.querySelector('.px-4.mb-6');
    if (oldCat) oldCat.remove();

    // Insert the new dynamic category panel at the top of marketplace-content
    const catDiv = document.createElement('div');
    catDiv.className = 'px-4 mb-4';
    catDiv.innerHTML = `
      <!-- Dynamic Categories/Subcategories (fetched via API) -->
      <div id="dynamic-categories" class="mb-2"></div>
      <!-- Search Bar (below categories) -->
      <div class="relative mb-6">
        <input type="text" id="shop-search-input" placeholder="Search products, artists..." class="w-full bg-gray-800 border border-gray-700 rounded-full px-4 py-3 pl-12 text-white placeholder-gray-400 focus:outline-none focus:border-purple-500" />
        <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
      </div>
    `;
    mktContent.prepend(catDiv);

    // Fetch categories & subcategories from backend
    fetch("/api/categories")
      .then(resp => resp.json())
      .then(categories => {
        // Example fallback for demo:
        if (!Array.isArray(categories) || !categories.length) {
          categories = [
            { name: "All", subcategories: [] },
            { name: "Paintings", subcategories: ["Artwork", "Prints"] },
            { name: "Drawings", subcategories: ["Charcoal", "Pencil", "Sketch"] },
            { name: "Sculptures", subcategories: ["Wood", "Clay", "Wire", "Steel"] },
            { name: "Art Materials", subcategories: ["Acrylic paints", "Oil paints", "Watercolor paints", "Gouache paints", "Spray paints / Airbrush paints", "Paint palettes", "Palette knives", "Mediums & varnishes", "Paint thinners", "Solvents", "Gesso", "Graphite pencils", "Colored pencils", "Charcoal sticks & pencils", "Pastels", "Conte crayons", "Erasers", "Sharpeners & Blades", "Blending stumps", "Tortillons", "Inks", "Technical pens", "Clay", "Stone blocks", "Wood carving blocks", "Plaster", "Resin kits", "Armatures", "Wire frames", "Molds & Mold-making materials", "Safety gear", "Canvases", "Canvas boards", "Panels", "Paper pads", "Bristol boards", "Wood panels", "Fabric for painting", "Glass/acrylic sheets for reverse painting", "Frames", "Frame mats", "Borders", "Hanging kits & wires", "Fixatives", "Sealants", "Varnish sprays", "Mounting adhesives", "Art storage & organization: Art bins", "Brush holders", "Easels", "Art desks", "Portfolios", "Art folders", "Travel kits", "Lighting equipment for art", "Drawing tablets/styluses", "Graphic tablets with screens", "Brushes", "Markers", "Stencil sets", "Tape", "Rulers", "Compasses", "Grids"] },
            { name: "Art Services", subcategories: ["Custom portrait", "Painting commissions", "Airbrush artwork (canvas, clothing, vehicles)", "Tattoo designs", "Calligraphy & lettering", "Digital illustration (logos, posters)", "Character design", "NFT creation & minting", "Mural painting", "Art restoration", "Photography & editing", "Video editing & animation", "Curation & gallery setup"] },
            { name: "Music Services", subcategories: ["Live performance bookings (bands, DJs, solo artists)", "Session musicians", "Voice coaching & vocal tracking", "Instrument lessons", "Beat production", "Mixing & mastering", "Songwriting & lyric writing", "Jingle creation", "DJ & event sound services", "Studio & equipment rental"] },
            { name: "Musical Instruments", subcategories: ["Brand new", "Secondhand"] },
            { name: "Electronics", subcategories: ["USB Audio Interfaces", "Thunderbolt Interfaces", "Portable/Mobile Interfaces", "Multi-channel Mixers with Interface", "Microphones (Condenser, Dynamic, Lavalier, USB, Broadcast)", "Microphone stands & shock mounts", "Pop filters & windshields", "Headphones & Monitors (Studio headphones, IEMs, DJ headphones, Studio monitors, Isolation pads)", "Digital Instruments (MIDI controllers, Digital pianos, Synthesizers, Drum machines, Samplers, Electronic drum pads, Keytar controllers)", "DJ & Live Gear (Controllers, Mixers, Turntables, CDJs, Effects units, Lighting controllers, Audio interfaces)", "Production Hardware (Field recorders, Preamps, Patchbays, Channel strips, EQs & compressors, Control surfaces)", "Software & Licenses (DAWs, VST plugins, Loop/sample libraries, Audio editors, Synth software, Virtual amps & effects)", "Accessories & Cables (XLR, TRS, RCA, MIDI cables, DI boxes, Organizers, Adapters, Racks, Soundproofing, USB hubs/stands)"] }
          ];
        }
        const catDiv = document.getElementById("dynamic-categories");
        catDiv.innerHTML = categories.map((cat, idx) => `
          <div class="inline-block mr-2 mb-2">
            <button class="category-btn bg-gray-700 text-gray-300 px-4 py-2 rounded-full text-sm whitespace-nowrap flex items-center ${idx === 0 ? "bg-purple-600 text-white" : ""}" data-category="${cat.name}" type="button">
              ${cat.name}
              ${cat.subcategories && cat.subcategories.length ? '<i class="fas fa-chevron-down ml-2 text-xs"></i>' : ''}
            </button>
            ${cat.subcategories && cat.subcategories.length ? `
              <div class="subcategory-dropdown hidden absolute z-20 bg-gray-900 rounded-lg shadow-lg mt-2 p-2 min-w-48 max-h-60 overflow-y-auto border border-gray-700" style="min-width:200px;">
                ${cat.subcategories.map(sub => `
                  <button class="subcategory-btn w-full text-left px-3 py-2 text-white hover:bg-gray-700 rounded" data-category="${cat.name}" data-subcategory="${sub}">${sub}</button>
                `).join("")}
              </div>
            ` : ""}
          </div>
        `).join("");

        // Add dropdown toggle logic for subcategories
        catDiv.querySelectorAll('.category-btn').forEach((btn, i) => {
          btn.addEventListener('click', function (e) {
            // Remove highlight from all
            catDiv.querySelectorAll('.category-btn').forEach(x => x.classList.remove('bg-purple-600', 'text-white'));
            btn.classList.add('bg-purple-600', 'text-white');
            // Hide all dropdowns
            catDiv.querySelectorAll('.subcategory-dropdown').forEach(x => x.classList.add('hidden'));
            // Show dropdown if any
            const dd = btn.parentElement.querySelector('.subcategory-dropdown');
            if (dd) dd.classList.toggle('hidden');
            // Filter products by category
            filterProductsByCategory(btn.dataset.category);
          });
        });
        // Subcategory click
        catDiv.querySelectorAll('.subcategory-btn').forEach(subBtn => {
          subBtn.addEventListener('click', function (e) {
            e.stopPropagation();
            filterProductsBySubcategory(subBtn.dataset.category, subBtn.dataset.subcategory);
            // Hide all dropdowns after
            catDiv.querySelectorAll('.subcategory-dropdown').forEach(x => x.classList.add('hidden'));
          });
        });
        // Hide dropdowns when clicking outside
        document.addEventListener('click', function (e) {
          if (!catDiv.contains(e.target)) {
            catDiv.querySelectorAll('.subcategory-dropdown').forEach(x => x.classList.add('hidden'));
          }
        });

        // Filtering logic
        function filterProductsByCategory(category) {
          const allProducts = mktContent.querySelectorAll('.product-card');
          if (category === 'All') {
            allProducts.forEach(p => p.style.display = 'block');
          } else {
            allProducts.forEach(p => {
              p.style.display = (p.getAttribute('data-category') && p.getAttribute('data-category').toLowerCase().includes(category.toLowerCase())) ? 'block' : 'none';
            });
          }
        }
        function filterProductsBySubcategory(category, subcategory) {
          const allProducts = mktContent.querySelectorAll('.product-card');
          // Here you can use a custom data-subcategory tag for each product, or just match text
          allProducts.forEach(p => {
            const prodCat = (p.getAttribute('data-category') || "").toLowerCase();
            const prodSub = (p.getAttribute('data-subcategory') || "").toLowerCase();
            if (prodCat.includes(category.toLowerCase()) && prodSub.includes(subcategory.toLowerCase())) {
              p.style.display = 'block';
            } else if (p.textContent.toLowerCase().includes(subcategory.toLowerCase())) {
              p.style.display = 'block';
            } else {
              p.style.display = 'none';
            }
          });
        }
      });

    // Search bar logic
    catDiv.querySelector("#shop-search-input").addEventListener("keyup", function (e) {
      const term = e.target.value.toLowerCase();
      const allProducts = mktContent.querySelectorAll('.product-card');
      allProducts.forEach(p => {
        p.style.display = p.textContent.toLowerCase().includes(term) ? 'block' : 'none';
      });
    });
  }

});
</script>
<!-- ... (your existing HTML above) ... -->
<script>
// Helper to open the camera modal (uses your existing startRecording function)
function goToCameraTab() {
    // Use your existing function to open the camera modal
    if (typeof startRecording === "function") {
        startRecording();
    }
}

// 1. Header nav (desktop)
document.querySelectorAll('.home-nav-buttons .nav-filter-btn').forEach(btn => {
    const filter = btn.getAttribute('data-filter');
    if (filter === 'busking' || filter === 'live') {
        btn.onclick = function(e) {
            e.preventDefault();
            goToCameraTab();
        };
    }
});
// 2. Mobile main nav (bottom bar)
document.querySelectorAll('.nav-btn').forEach(btn => {
    const tab = btn.getAttribute('data-tab');
    // Only override if it is busking or live
    if (tab === 'busking' || tab === 'live') {
        btn.onclick = function(e) {
            e.preventDefault();
            goToCameraTab();
        };
    }
});
// 3. In case you have any other busking/live navs, catch them by icon or text as fallback (optional)
document.querySelectorAll('button').forEach(btn => {
    if (
        btn.innerText.trim().toLowerCase().includes('busking') ||
        btn.innerText.trim().toLowerCase().includes('live')
    ) {
        btn.onclick = function(e) {
            e.preventDefault();
            goToCameraTab();
        };
    }
});
</script>
<script>
// Mobile & Desktop: Open camera modal on Busking/Live button click

function goToCameraTab() {
    if (typeof startRecording === "function") {
        startRecording();
        // On mobile: prevent background scroll when modal is open
        document.body.style.overflow = "hidden";
        // Make camera modal full-screen on mobile
        var camModal = document.getElementById('cameraModal');
        if (camModal) {
            camModal.style.height = "100vh";
            camModal.style.width = "100vw";
            camModal.style.maxWidth = "100vw";
            camModal.style.maxHeight = "100vh";
            camModal.style.top = "0";
            camModal.style.left = "0";
        }
    }
}
// Restore scroll when camera modal is closed (assuming you use closeCameraModal)
const origCloseCameraModal = window.closeCameraModal;
window.closeCameraModal = function() {
    document.body.style.overflow = "";
    if (origCloseCameraModal) origCloseCameraModal();
};

// 1. Home nav (desktop and mobile, top and bottom)
document.querySelectorAll('.home-nav-buttons .nav-filter-btn, .nav-btn').forEach(btn => {
    const filter = btn.getAttribute('data-filter') || btn.getAttribute('data-tab');
    if (filter === 'busking' || filter === 'live') {
        btn.onclick = function(e) {
            e.preventDefault();
            goToCameraTab();
        };
    }
});
// 2. Fallback for any stray Busking/Live navs
document.querySelectorAll('button').forEach(btn => {
    if (
        btn.innerText.trim().toLowerCase().includes('busking') ||
        btn.innerText.trim().toLowerCase().includes('live')
    ) {
        btn.onclick = function(e) {
            e.preventDefault();
            goToCameraTab();
        };
    }
});
</script>
<script>
// ---------------------- SHOP TOP NAV BUTTONS (CRUD, API, Responsive) ----------------------
document.addEventListener("DOMContentLoaded", function () {
  // Insert navigation buttons at the top of the shop tab
  const shopNav = document.querySelector("#shop-content .flex.justify-center.space-x-4");
  if (shopNav) {
    shopNav.innerHTML = `
      <button id="shop-voucher-btn" class="top-nav-item px-4 py-2 rounded-full text-sm font-medium hover:scale-105 transition-all"><i class="fas fa-ticket-alt mr-2"></i>Voucher</button>
      <button id="shop-orders-btn" class="top-nav-item px-4 py-2 rounded-full text-sm font-medium hover:scale-105 transition-all"><i class="fas fa-box mr-2"></i>Orders</button>
      <button id="shop-payment-btn" class="top-nav-item px-4 py-2 rounded-full text-sm font-medium hover:scale-105 transition-all"><i class="fas fa-credit-card mr-2"></i>Payment</button>
      <button id="shop-messages-btn" class="top-nav-item px-4 py-2 rounded-full text-sm font-medium hover:scale-105 transition-all"><i class="fas fa-envelope mr-2"></i>Messages</button>
      <button id="shop-returns-btn" class="top-nav-item px-4 py-2 rounded-full text-sm font-medium hover:scale-105 transition-all"><i class="fas fa-undo mr-2"></i>Returns</button>
      <button id="shop-address-btn" class="top-nav-item px-4 py-2 rounded-full text-sm font-medium hover:scale-105 transition-all"><i class="fas fa-map-marked-alt mr-2"></i>Address</button>
    `;
  }

  function showShopModal(id, contentHTML, onOpen) {
    let modal = document.getElementById(id);
    if (!modal) {
      modal = document.createElement("div");
      modal.id = id;
      modal.className = "fixed inset-0 bg-black/80 z-[200] flex items-center justify-center";
      modal.innerHTML = `
        <div class="bg-gray-900 p-6 rounded-xl w-full max-w-md mx-4 relative">
          <button onclick="document.getElementById('${id}').remove();" class="absolute top-4 right-4 p-1 rounded-full hover:bg-gray-700">
            <i class="fas fa-times text-lg"></i>
          </button>
          ${contentHTML}
        </div>
      `;
      document.body.appendChild(modal);
    }
    if (onOpen) onOpen(modal);
  }

  // Voucher CRUD
  document.getElementById("shop-voucher-btn").onclick = function () {
    showShopModal(
      "shopVoucherModal",
      `
      <h2 class="text-xl font-bold mb-4">My Vouchers</h2>
      <div id="voucher-list" class="mb-4"></div>
      <form id="voucher-redeem-form" class="flex gap-2">
        <input type="text" id="voucher-code-input" placeholder="Enter voucher code..." class="flex-1 bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-sm" />
        <button type="submit" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">Redeem</button>
      </form>
      <div id="voucher-message" class="mt-2 text-sm"></div>
      `,
      function (modal) {
        fetch("/api/vouchers")
          .then(resp => resp.json())
          .then(data => {
            const list = modal.querySelector("#voucher-list");
            if (data.length === 0) {
              list.innerHTML = `<div class="text-gray-400">No vouchers available.</div>`;
            } else {
              list.innerHTML = data.map(v =>
                `<div class="bg-gray-800 rounded-lg px-4 py-2 mb-2 flex justify-between items-center">
                  <div>
                    <span class="font-semibold">${v.code}</span>
                    <span class="ml-2 text-xs text-gray-400">${v.description}</span>
                    <span class="ml-2 text-xs text-green-400">${v.discount}% OFF</span>
                  </div>
                  <button onclick="navigator.clipboard.writeText('${v.code}')" class="text-xs bg-gray-700 rounded px-2 py-1">Copy</button>
                </div>`
              ).join("");
            }
          });
        modal.querySelector("#voucher-redeem-form").onsubmit = function (e) {
          e.preventDefault();
          const code = modal.querySelector("#voucher-code-input").value.trim();
          fetch("/api/vouchers/redeem", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ code })
          }).then(r => r.json())
            .then(resp => {
              modal.querySelector("#voucher-message").textContent = resp.message || (resp.success ? "Voucher redeemed!" : "Invalid voucher.");
              if (resp.success) setTimeout(() => modal.remove(), 1500);
            })
            .catch(() => { modal.querySelector("#voucher-message").textContent = "Error redeeming voucher."; });
        };
      }
    );
  };

  // Orders CRUD
  document.getElementById("shop-orders-btn").onclick = function () {
    showShopModal(
      "shopOrdersModal",
      `<h2 class="text-xl font-bold mb-4">My Orders</h2><div id="order-list" class="space-y-4"></div>`,
      function (modal) {
        fetch("/api/orders")
          .then(resp => resp.json())
          .then(data => {
            const list = modal.querySelector("#order-list");
            if (!data.length) {
              list.innerHTML = `<div class="text-gray-400">No orders found.</div>`;
            } else {
              list.innerHTML = data.map(order => `
                <div class="bg-gray-800 rounded-lg p-4">
                  <div class="flex justify-between items-center mb-2">
                    <span class="font-semibold">Order #${order.id}</span>
                    <span class="text-xs ${order.status === 'Delivered' ? 'text-green-400' : 'text-yellow-400'}">${order.status}</span>
                  </div>
                  <div class="text-xs text-gray-400 mb-1">${order.date}</div>
                  <div class="text-sm mb-2">${order.items.map(i => `${i.title} x${i.qty}`).join(", ")}</div>
                  <div class="font-bold text-purple-400">₱${order.total.toLocaleString()}</div>
                  <button onclick="fetch('/api/orders/${order.id}/details').then(r=>r.json()).then(d=>alert(JSON.stringify(d,null,2)))" class="mt-2 text-xs px-3 py-1 bg-gray-700 rounded">View Details</button>
                </div>
              `).join("");
            }
          });
      }
    );
  };

  // Payment CRUD
  document.getElementById("shop-payment-btn").onclick = function () {
    showShopModal(
      "shopPaymentModal",
      `
      <h2 class="text-xl font-bold mb-4">Payment Methods</h2>
      <div id="payment-methods-list"></div>
      <button id="add-payment-method-btn" class="mt-4 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">Add Method</button>
      `,
      function (modal) {
        function loadMethods() {
          fetch("/api/payments/methods")
            .then(resp => resp.json())
            .then(data => {
              const list = modal.querySelector("#payment-methods-list");
              if (!data.length) {
                list.innerHTML = `<div class="text-gray-400">No payment methods saved.</div>`;
              } else {
                list.innerHTML = data.map(pm => `
                  <div class="bg-gray-800 rounded-lg px-4 py-2 mb-2 flex justify-between items-center">
                    <span>${pm.type === 'paypal' ? '<i class="fab fa-paypal text-blue-400"></i>' : pm.type === 'gcash' ? '<img src="https://upload.wikimedia.org/wikipedia/commons/0/09/GCash_logo.png" alt="GCash" style="height:20px;display:inline;margin-right:4px;">' : '<i class="fas fa-credit-card"></i>'}
                    ${pm.details}</span>
                    <button onclick="fetch('/api/payments/methods/${pm.id}',{method:'DELETE'}).then(()=>loadMethods())" class="text-xs bg-gray-700 rounded px-2 py-1">Remove</button>
                  </div>
                `).join("");
              }
            });
        }
        loadMethods();
        modal.querySelector("#add-payment-method-btn").onclick = function () {
          alert("Show Add Payment Method Form (GCash, PayPal, Card, etc).");
        };
      }
    );
  };

  // Messages CRUD
  document.getElementById("shop-messages-btn").onclick = function () {
    showShopModal(
      "shopMessagesModal",
      `<h2 class="text-xl font-bold mb-4">Shop Messages</h2><div id="shop-messages-list" class="space-y-3"></div>`,
      function (modal) {
        fetch("/api/messages")
          .then(resp => resp.json())
          .then(data => {
            const list = modal.querySelector("#shop-messages-list");
            if (!data.length) {
              list.innerHTML = `<div class="text-gray-400">No messages.</div>`;
            } else {
              list.innerHTML = data.map(msg =>
                `<div class="bg-gray-800 rounded-lg p-3">
                  <div class="flex justify-between items-center mb-1">
                    <span class="font-semibold">${msg.title}</span>
                    <span class="text-xs text-gray-400">${new Date(msg.date).toLocaleString()}</span>
                  </div>
                  <div class="text-gray-300 text-sm">${msg.body}</div>
                </div>`
              ).join("");
            }
          });
      }
    );
  };

  // Returns CRUD
  document.getElementById("shop-returns-btn").onclick = function () {
    showShopModal(
      "shopReturnsModal",
      `
      <h2 class="text-xl font-bold mb-4">Return Requests</h2>
      <div id="returns-list" class="mb-4"></div>
      <button id="create-return-btn" class="bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 transition">Request Return</button>
      `,
      function (modal) {
        function loadReturns() {
          fetch("/api/returns")
            .then(r => r.json())
            .then(data => {
              const list = modal.querySelector("#returns-list");
              if (!data.length) {
                list.innerHTML = `<div class="text-gray-400">No return requests.</div>`;
              } else {
                list.innerHTML = data.map(ret =>
                  `<div class="bg-gray-800 rounded-lg p-3 mb-2">
                    <div class="flex justify-between items-center mb-1">
                      <span>Order #${ret.order_id}</span>
                      <span class="text-xs text-yellow-400">${ret.status}</span>
                    </div>
                    <div class="text-xs text-gray-400">Reason: ${ret.reason}</div>
                  </div>`
                ).join("");
              }
            });
        }
        loadReturns();
        modal.querySelector("#create-return-btn").onclick = function () {
          const orderId = prompt("Enter Order ID for return:");
          const reason = prompt("Reason for return:");
          if (!orderId || !reason) return;
          fetch("/api/returns", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ order_id: orderId, reason })
          }).then(() => loadReturns());
        };
      }
    );
  };

  // Address CRUD
  document.getElementById("shop-address-btn").onclick = function () {
    showShopModal(
      "shopAddressModal",
      `
      <h2 class="text-xl font-bold mb-4">Manage Addresses</h2>
      <div id="address-list"></div>
      <button id="add-address-btn" class="mt-4 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">Add Address</button>
      `,
      function (modal) {
        function loadAddresses() {
          fetch("/api/addresses")
            .then(r => r.json())
            .then(data => {
              const list = modal.querySelector("#address-list");
              if (!data.length) {
                list.innerHTML = `<div class="text-gray-400">No addresses found.</div>`;
              } else {
                list.innerHTML = data.map(addr =>
                  `<div class="bg-gray-800 rounded-lg px-4 py-2 mb-2 flex justify-between items-center">
                    <div>
                      <div class="font-semibold">${addr.label || addr.name}</div>
                      <div class="text-xs text-gray-400">${addr.address}, ${addr.city}, ${addr.postal} <span class="ml-1">${addr.type ? '(' + addr.type + ')' : ''}</span></div>
                    </div>
                    <button onclick="fetch('/api/addresses/${addr.id}',{method:'DELETE'}).then(()=>loadAddresses())" class="text-xs bg-gray-700 rounded px-2 py-1">Delete</button>
                  </div>`
                ).join("");
              }
            });
        }
        loadAddresses();
        modal.querySelector("#add-address-btn").onclick = function () {
          const name = prompt("Name/Label:");
          const address = prompt("Address:");
          const city = prompt("City:");
          const postal = prompt("Postal Code:");
          if (!name || !address || !city || !postal) return;
          fetch("/api/addresses", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name, address, city, postal })
          }).then(() => loadAddresses());
        };
      }
    );
  };

  // ---------------------- DYNAMIC CATEGORIES & SUBCATEGORIES + SEARCH ----------------------
  const mktContent = document.getElementById('marketplace-content');
  if (mktContent) {
    const oldCat = mktContent.querySelector('.px-4.mb-6');
    if (oldCat) oldCat.remove();

    const catDiv = document.createElement('div');
    catDiv.className = 'px-4 mb-4';
    catDiv.innerHTML = `
      <div id="dynamic-categories" class="mb-2"></div>
      <div class="relative mb-6">
        <input type="text" id="shop-search-input" placeholder="Search products, artists..." class="w-full bg-gray-800 border border-gray-700 rounded-full px-4 py-3 pl-12 text-white placeholder-gray-400 focus:outline-none focus:border-purple-500" />
        <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
      </div>
    `;
    mktContent.prepend(catDiv);

    // For demo, fallback to hardcoded categories if no API available
    fetch("/api/categories")
      .then(resp => resp.json())
      .catch(() => null)
      .then(categories => {
        if (!Array.isArray(categories) || !categories.length) {
          categories = [
            { name: "All", subcategories: [] },
            { name: "Paintings", subcategories: ["Artwork", "Prints"] },
            { name: "Drawings", subcategories: ["Charcoal", "Pencil", "Sketch"] },
            { name: "Sculptures", subcategories: ["Wood", "Clay", "Wire", "Steel"] },
            { name: "Art Materials", subcategories: ["Acrylic paints", "Oil paints", "Watercolor paints", "Gouache paints", "Spray paints / Airbrush paints", "Paint palettes", "Palette knives", "Mediums & varnishes", "Paint thinners", "Solvents", "Gesso", "Graphite pencils", "Colored pencils", "Charcoal sticks & pencils", "Pastels", "Conte crayons", "Erasers", "Sharpeners & Blades", "Blending stumps", "Tortillons", "Inks", "Technical pens", "Clay", "Stone blocks", "Wood carving blocks", "Plaster", "Resin kits", "Armatures", "Wire frames", "Molds & Mold-making materials", "Safety gear", "Canvases", "Canvas boards", "Panels", "Paper pads", "Bristol boards", "Wood panels", "Fabric for painting", "Glass/acrylic sheets for reverse painting", "Frames", "Frame mats", "Borders", "Hanging kits & wires", "Fixatives", "Sealants", "Varnish sprays", "Mounting adhesives", "Art storage & organization: Art bins", "Brush holders", "Easels", "Art desks", "Portfolios", "Art folders", "Travel kits", "Lighting equipment for art", "Drawing tablets/styluses", "Graphic tablets with screens", "Brushes", "Markers", "Stencil sets", "Tape", "Rulers", "Compasses", "Grids"] },
            { name: "Art Services", subcategories: ["Custom portrait", "Painting commissions", "Airbrush artwork (canvas, clothing, vehicles)", "Tattoo designs", "Calligraphy & lettering", "Digital illustration (logos, posters)", "Character design", "NFT creation & minting", "Mural painting", "Art restoration", "Photography & editing", "Video editing & animation", "Curation & gallery setup"] },
            { name: "Music Services", subcategories: ["Live performance bookings (bands, DJs, solo artists)", "Session musicians", "Voice coaching & vocal tracking", "Instrument lessons", "Beat production", "Mixing & mastering", "Songwriting & lyric writing", "Jingle creation", "DJ & event sound services", "Studio & equipment rental"] },
            { name: "Musical Instruments", subcategories: ["Brand new", "Secondhand"] },
            { name: "Electronics", subcategories: ["USB Audio Interfaces", "Thunderbolt Interfaces", "Portable/Mobile Interfaces", "Multi-channel Mixers with Interface", "Microphones (Condenser, Dynamic, Lavalier, USB, Broadcast)", "Microphone stands & shock mounts", "Pop filters & windshields", "Headphones & Monitors (Studio headphones, IEMs, DJ headphones, Studio monitors, Isolation pads)", "Digital Instruments (MIDI controllers, Digital pianos, Synthesizers, Drum machines, Samplers, Electronic drum pads, Keytar controllers)", "DJ & Live Gear (Controllers, Mixers, Turntables, CDJs, Effects units, Lighting controllers, Audio interfaces)", "Production Hardware (Field recorders, Preamps, Patchbays, Channel strips, EQs & compressors, Control surfaces)", "Software & Licenses (DAWs, VST plugins, Loop/sample libraries, Audio editors, Synth software, Virtual amps & effects)", "Accessories & Cables (XLR, TRS, RCA, MIDI cables, DI boxes, Organizers, Adapters, Racks, Soundproofing, USB hubs/stands)"] }
          ];
        }
        const catDiv = document.getElementById("dynamic-categories");
        catDiv.innerHTML = categories.map((cat, idx) => `
          <div class="inline-block mr-2 mb-2 relative">
            <button class="category-btn bg-gray-700 text-gray-300 px-4 py-2 rounded-full text-sm whitespace-nowrap flex items-center ${idx === 0 ? "bg-purple-600 text-white" : ""}" data-category="${cat.name}" type="button">
              ${cat.name}
              ${cat.subcategories && cat.subcategories.length ? '<i class="fas fa-chevron-down ml-2 text-xs"></i>' : ''}
            </button>
            ${cat.subcategories && cat.subcategories.length ? `
              <div class="subcategory-dropdown hidden absolute z-20 bg-gray-900 rounded-lg shadow-lg mt-2 p-2 min-w-48 max-h-60 overflow-y-auto border border-gray-700" style="min-width:200px;">
                ${cat.subcategories.map(sub => `
                  <button class="subcategory-btn w-full text-left px-3 py-2 text-white hover:bg-gray-700 rounded" data-category="${cat.name}" data-subcategory="${sub}">${sub}</button>
                `).join("")}
              </div>
            ` : ""}
          </div>
        `).join("");

        // Dropdown logic for subcategories
        catDiv.querySelectorAll('.category-btn').forEach((btn, i) => {
          btn.addEventListener('click', function (e) {
            catDiv.querySelectorAll('.category-btn').forEach(x => x.classList.remove('bg-purple-600', 'text-white'));
            btn.classList.add('bg-purple-600', 'text-white');
            catDiv.querySelectorAll('.subcategory-dropdown').forEach(x => x.classList.add('hidden'));
            const dd = btn.parentElement.querySelector('.subcategory-dropdown');
            if (dd) dd.classList.toggle('hidden');
            filterProductsByCategory(btn.dataset.category);
          });
        });
        catDiv.querySelectorAll('.subcategory-btn').forEach(subBtn => {
          subBtn.addEventListener('click', function (e) {
            e.stopPropagation();
            filterProductsBySubcategory(subBtn.dataset.category, subBtn.dataset.subcategory);
            catDiv.querySelectorAll('.subcategory-dropdown').forEach(x => x.classList.add('hidden'));
          });
        });
        document.addEventListener('click', function (e) {
          if (!catDiv.contains(e.target)) {
            catDiv.querySelectorAll('.subcategory-dropdown').forEach(x => x.classList.add('hidden'));
          }
        });

        function filterProductsByCategory(category) {
          const allProducts = mktContent.querySelectorAll('.product-card');
          if (category === 'All') {
            allProducts.forEach(p => p.style.display = 'block');
          } else {
            allProducts.forEach(p => {
              p.style.display = (p.getAttribute('data-category') && p.getAttribute('data-category').toLowerCase().includes(category.toLowerCase())) ? 'block' : 'none';
            });
          }
        }
        function filterProductsBySubcategory(category, subcategory) {
          const allProducts = mktContent.querySelectorAll('.product-card');
          allProducts.forEach(p => {
            const prodCat = (p.getAttribute('data-category') || "").toLowerCase();
            const prodSub = (p.getAttribute('data-subcategory') || "").toLowerCase();
            if (prodCat.includes(category.toLowerCase()) && prodSub.includes(subcategory.toLowerCase())) {
              p.style.display = 'block';
            } else if (p.textContent.toLowerCase().includes(subcategory.toLowerCase())) {
              p.style.display = 'block';
            } else {
              p.style.display = 'none';
            }
          });
        }
      });

    catDiv.querySelector("#shop-search-input").addEventListener("keyup", function (e) {
      const term = e.target.value.toLowerCase();
      const allProducts = mktContent.querySelectorAll('.product-card');
      allProducts.forEach(p => {
        p.style.display = p.textContent.toLowerCase().includes(term) ? 'block' : 'none';
      });
    });
  }
});
</script>
</body>
</html>
  </body>
  </html>